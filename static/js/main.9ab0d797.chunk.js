(this["webpackJsonpscran.js"]=this["webpackJsonpscran.js"]||[]).push([[0],{290:function(e,t,n){},291:function(e,t,n){},293:function(e,t,n){},320:function(e,t,n){},321:function(e,t,n){},333:function(e,t,n){},334:function(e,t,n){},335:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(24),s=n.n(c),r=(n(290),n(7)),l=n(28),i=n(6),o=(n(291),n(344)),u=n(45),d=n(56),j=n(3),b=n(19),h=n(343),O=n(1),f=Object(a.createContext)(null),p=function(e){var t=e.children,n=Object(a.useState)({gene:null,mtx:null,barcode:null}),c=Object(i.a)(n,2),s=c[0],r=c[1],l=Object(a.useState)({qc:{"qc-nmads":3},fSelection:{"fsel-span":.3},pca:{"pca-npc":5},cluster:{"clus-k":10,"clus-res":.5,"clus-scheme":0},tsne:{"tsne-iter":500,"tsne-perp":30},umap:{"umap-nn":15,"umap-epochs":500,"umap-min_dist":.01,"umap-approx_nn":!0},markerGene:{}}),o=Object(i.a)(l,2),u=o[0],d=o[1],j=Object(a.useState)(!1),b=Object(i.a)(j,2),h=b[0],p=b[1],m=Object(a.useState)(null),x=Object(i.a)(m,2),v=x[0],g=x[1],F=Object(a.useState)(null),C=Object(i.a)(F,2),y=C[0],D=C[1],A=Object(a.useState)(null),w=Object(i.a)(A,2),N=w[0],E=w[1],S=Object(a.useState)(null),k=Object(i.a)(S,2),B=k[0],T=k[1],R=Object(a.useState)(null),M=Object(i.a)(R,2),I=M[0],_=M[1],P=Object(a.useState)(null),q=Object(i.a)(P,2),G=q[0],L=q[1],V=Object(a.useState)(null),U=Object(i.a)(V,2),z=U[0],H=U[1],W=Object(a.useState)([]),Q=Object(i.a)(W,2),J=Q[0],K=Q[1],X=Object(a.useState)(null),Y=Object(i.a)(X,2),$=Y[0],Z=Y[1],ee=Object(a.useState)(null),te=Object(i.a)(ee,2),ne=te[0],ae=te[1],ce=Object(a.useState)(null),se=Object(i.a)(ce,2),re=se[0],le=se[1],ie=Object(a.useState)(null),oe=Object(i.a)(ie,2),ue=oe[0],de=oe[1],je=Object(a.useState)({}),be=Object(i.a)(je,2),he=be[0],Oe=be[1],fe=Object(a.useState)(null),pe=Object(i.a)(fe,2),me=pe[0],xe=pe[1],ve=Object(a.useState)(null),ge=Object(i.a)(ve,2),Fe=ge[0],Ce=ge[1],ye=Object(a.useState)(null),De=Object(i.a)(ye,2),Ae=De[0],we=De[1],Ne=Object(a.useState)(null),Ee=Object(i.a)(Ne,2),Se=Ee[0],ke=Ee[1],Be=Object(a.useState)(null),Te=Object(i.a)(Be,2),Re=Te[0],Me=Te[1],Ie=Object(a.useState)(null),_e=Object(i.a)(Ie,2),Pe=_e[0],qe=_e[1],Ge=Object(a.useState)(null),Le=Object(i.a)(Ge,2),Ve=Le[0],Ue=Le[1],ze=Object(a.useState)(null),He=Object(i.a)(ze,2),We=He[0],Qe=He[1],Je=Object(a.useState)([]),Ke=Object(i.a)(Je,2),Xe=Ke[0],Ye=Ke[1];return Object(a.useEffect)((function(){h&&null!=s.mtx&&window.Worker.postMessage({type:"RUN",payload:{files:[s.mtx,s.barcode?s.barcode[0]:[],s.gene?s.gene[0]:[]],params:u},msg:"not much to pass"})}),[s,u,h]),Object(O.jsx)(f.Provider,{value:{inputFiles:s,setInputFiles:r,params:u,setParams:d,error:v,setError:g,wasmInitialized:h,setWasmInitialized:p,pcaData:Ae,setPcaData:we,pcaVarExp:Se,setPcaVarExp:ke,tsneData:Re,setTsneData:Me,umapData:Pe,setUmapData:qe,initDims:y,setInitDims:D,qcDims:N,setQcDims:E,qcData:I,setQcData:_,qcThreshold:G,setQcThreshold:L,fSelDims:B,setFSelDims:T,redDims:J,setRedDims:K,defaultRedDims:$,setDefaultRedDims:Z,plotRedDims:ne,setPlotRedDims:ae,clusterData:re,setClusterData:le,fSelectionData:z,setFSelectionData:H,logs:Xe,setLogs:Ye,selectedCluster:ue,setSelectedCluster:de,selectedClusterSummary:he,setSelectedClusterSummary:Oe,clusterRank:Fe,setClusterRank:Ce,gene:Ve,setGene:Ue,clusterColors:me,setClusterColors:xe,reqGene:We,setReqGene:Qe},children:t})},m=(n(293),["buttonText","includeFooter"]);var x=function(e){var t=e.buttonText,n=e.includeFooter,c=Object(d.a)(e,m),s=Object(a.useState)(!1),l=Object(i.a)(s,2),u=l[0],p=l[1],x=Object(a.useCallback)((function(){return p(!u)}),[u]),v=Object(a.useCallback)((function(){return p(!1)}),[]),g=Object(a.useContext)(f),F=g.inputFiles,C=g.setInputFiles,y=g.params,D=g.setParams,A=Object(a.useState)(F),w=Object(i.a)(A,2),N=w[0],E=w[1],S=Object(a.useState)(y),k=Object(i.a)(S,2),B=k[0],T=k[1],R=Object(a.useState)({mtx:"Choose mtx file...",gene:"Choose gene file...",barcode:"Choose barcode file..."}),M=Object(i.a)(R,2),I=M[0],_=M[1];return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(o.a,{onClick:x,icon:"social-media",intent:"primary",text:t}),Object(O.jsxs)(o.g,Object(r.a)(Object(r.a)({className:"analysis-dialog"},c),{},{isOpen:u,onClose:v,children:[Object(O.jsxs)("div",{className:j.a.DIALOG_BODY,children:[Object(O.jsx)("div",{className:"col",children:Object(O.jsxs)("div",{children:[Object(O.jsxs)(o.j,{children:[Object(O.jsx)(o.w,{large:!0,round:!0,children:"1"})," Import Single cell dataset"]}),Object(O.jsxs)("div",{className:"row",children:[Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsx)(o.x,{className:"text-100",children:"Choose mtx file"}),Object(O.jsx)(o.i,{text:null===I||void 0===I?void 0:I.mtx,onInputChange:function(e){_(Object(r.a)(Object(r.a)({},I),{},{mtx:e.target.files[0].name})),E(Object(r.a)(Object(r.a)({},N),{},{mtx:e.target.files}))}})]}),Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsx)(o.x,{className:"text-100",children:"Choose gene file"}),Object(O.jsx)(o.i,{text:null===I||void 0===I?void 0:I.gene,onInputChange:function(e){_(Object(r.a)(Object(r.a)({},I),{},{gene:e.target.files[0].name})),E(Object(r.a)(Object(r.a)({},N),{},{gene:e.target.files}))}})]}),Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsx)(o.x,{className:"text-100",children:"Choose barcode file"}),Object(O.jsx)(o.i,{text:null===I||void 0===I?void 0:I.barcode,onInputChange:function(e){_(Object(r.a)(Object(r.a)({},I),{},{barcode:e.target.files[0].name})),E(Object(r.a)(Object(r.a)({},N),{},{barcode:e.target.files}))}})]})]})]})}),Object(O.jsx)("div",{className:"col",children:Object(O.jsxs)("div",{children:[Object(O.jsxs)(o.j,{children:[Object(O.jsx)(o.w,{large:!0,round:!0,children:"2"})," QC: Generate per cell QC metrics and filter cells"]}),Object(O.jsx)("div",{className:"row",children:Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsxs)(o.x,{className:"text-100",children:["NMADS",Object(O.jsx)(h.a,{className:"row-tooltip",content:"Number of MADs from the median, to use for defining outliers.(defaults to 3)",position:b.a.RIGHT,openOnTargetFocus:!1,children:Object(O.jsx)(o.l,{icon:"help"})})]}),Object(O.jsx)(o.s,{placeholder:"3",value:B.qc["qc-nmads"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{qc:{"qc-nmads":e}}))}})]})})]})}),Object(O.jsx)("div",{className:"col",children:Object(O.jsxs)("div",{children:[Object(O.jsxs)(o.j,{children:[Object(O.jsx)(o.w,{large:!0,round:!0,children:"3"})," Feature Selection: Model the variance of the log-expression values for each gene, accounting for the mean-variance trend"]}),Object(O.jsx)("div",{className:"row",children:Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsxs)(o.x,{className:"text-100",children:["Span factor",Object(O.jsx)(h.a,{className:"row-tooltip",content:"The span of the LOWESS smoother for fitting the mean-variance trend.(defaults to 0.3)",position:b.a.RIGHT,openOnTargetFocus:!1,children:Object(O.jsx)(o.l,{icon:"help"})})]}),Object(O.jsx)(o.s,{placeholder:"0.3",value:B.fSelection["fsel-span"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{fSelection:{"fsel-span":e}}))}})]})})]})}),Object(O.jsx)("div",{className:"col",children:Object(O.jsxs)("div",{children:[Object(O.jsxs)(o.j,{children:[Object(O.jsx)(o.w,{large:!0,round:!0,children:"4"})," PCA: Perform a principal components analysis to obtain per-cell coordinates in low-dimensional space"]}),Object(O.jsx)("div",{className:"row",children:Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsx)(o.x,{className:"text-100",children:"# of PCs (defaults to 5)"}),Object(O.jsx)(o.s,{placeholder:"5",value:B.pca["pca-npc"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{pca:{"pca-npc":e}}))}})]})})]})}),Object(O.jsx)("div",{className:"col",children:Object(O.jsxs)("div",{children:[Object(O.jsxs)(o.j,{children:[Object(O.jsx)(o.w,{large:!0,round:!0,children:"5"})," Cluster Analysis: Generate SNN graph and cluster cells"]}),Object(O.jsxs)("div",{className:"row",children:[Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsxs)(o.x,{className:"text-100",children:["# of neighbors",Object(O.jsx)(h.a,{className:"row-tooltip",content:"Number of neighbors to use to construct the nearest neighbor graph.(defaults to 10)",position:b.a.RIGHT,openOnTargetFocus:!1,children:Object(O.jsx)(o.l,{icon:"help"})})]}),Object(O.jsx)(o.s,{placeholder:"10",value:B.cluster["clus-k"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{cluster:{"clus-k":e}}))}})]}),Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsxs)(o.x,{className:"text-100",children:["Scheme",Object(O.jsx)(h.a,{className:"row-tooltip",content:"0 for approx, 1 ..., 2 for jaccard index",position:b.a.RIGHT,openOnTargetFocus:!1,children:Object(O.jsx)(o.l,{icon:"help"})})]}),Object(O.jsxs)(o.k,{onChange:function(e,t){var n;return T(Object(r.a)(Object(r.a)({},B),{},{cluster:{"clus-scheme":parseInt(null===e||void 0===e||null===(n=e.currentTarget)||void 0===n?void 0:n.value)}}))},children:[Object(O.jsx)("option",{children:"0"},"0"),Object(O.jsx)("option",{children:"1"},"1"),Object(O.jsx)("option",{children:"2"},"2")]})]}),Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsxs)(o.x,{className:"text-100",children:["Resolution",Object(O.jsx)(h.a,{className:"row-tooltip",content:"Resolution of the multi-level clustering, used in the modularity calculation.Larger values yield more fine-grained clusters.(defaults to 0.5)",position:b.a.RIGHT,openOnTargetFocus:!1,children:Object(O.jsx)(o.l,{icon:"help"})})]}),Object(O.jsx)(o.s,{placeholder:"0.5",value:B.cluster["clus-res"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{cluster:{"clus-res":e}}))}})]})]})]})}),Object(O.jsx)("div",{className:"col",children:Object(O.jsxs)("div",{children:[Object(O.jsxs)(o.j,{children:[Object(O.jsx)(o.w,{large:!0,round:!0,children:"6"})," t-SNE: Compute t-SNE embeddings and Visualize cells"]}),Object(O.jsxs)("div",{className:"row",children:[Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsx)(o.x,{className:"text-100",children:"Iterations (defaults to 500)"}),Object(O.jsx)(o.s,{placeholder:"500",value:B.tsne["tsne-iter"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{tsne:{"tsne-iter":e}}))}})]}),Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsx)(o.x,{className:"text-100",children:"Perplexity (defaults to 30)"}),Object(O.jsx)(o.s,{placeholder:"30",value:B.tsne["tsne-perp"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{tsne:{"tsne-perp":e}}))}})]})]})]})}),Object(O.jsx)("div",{className:"col",children:Object(O.jsxs)("div",{children:[Object(O.jsxs)(o.j,{children:[Object(O.jsx)(o.w,{large:!0,round:!0,children:"6"})," UMAP: Compute UMAP embeddings and Visualize cells"]}),Object(O.jsxs)("div",{className:"row",children:[Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsx)(o.x,{className:"text-100",children:"Num of Neighbors (defaults to 15)"}),Object(O.jsx)(o.s,{placeholder:"15",value:B.umap["umap-nn"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{umap:{"umap-nn":e}}))}})]}),Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsx)(o.x,{className:"text-100",children:"Epochs (defaults to 500)"}),Object(O.jsx)(o.s,{placeholder:"500",value:B.umap["umap-epoch"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{umap:{"umap-epoch":e}}))}})]}),Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsx)(o.x,{className:"text-100",children:"Min Distance (defaults to 0.01)"}),Object(O.jsx)(o.s,{placeholder:"0.01",value:B.umap["umap-min_dist"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{umap:{"umap-min_dist":e}}))}})]}),Object(O.jsxs)(o.n,{className:"row-input",children:[Object(O.jsx)(o.x,{className:"text-100",children:"Use Approximate Neighbor Search ? (true for fast UMAP calculation))"}),Object(O.jsx)(o.s,{placeholder:"0.01",value:B.umap["umap-approx_nn"],onValueChange:function(e,t){T(Object(r.a)(Object(r.a)({},B),{},{umap:{"umap-approx_nn":e}}))}})]})]})]})})]}),n?Object(O.jsx)("div",{className:j.a.DIALOG_FOOTER,children:Object(O.jsx)("div",{className:j.a.DIALOG_FOOTER_ACTIONS,children:Object(O.jsx)(h.a,{content:"Run Analysis",children:Object(O.jsx)(o.a,{icon:"function",onClick:function(){D(B),C(N),v()},children:"Analyze"})})})}):Object(O.jsx)("div",{style:{margin:"0 20px"}})]}))]})},v=function(){var e=Object(a.useContext)(f),t=e.initDims,n=e.qcDims;return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("span",{children:["Dataset Dims: ",t,n?" (After QC: ".concat(n,")"):" (After QC: ??? X ???)"]})})},g=function(){var e=Object(a.useContext)(f).logs,t=Object(a.useState)({autoFocus:!0,canEscapeKeyClose:!0,canOutsideClickClose:!0,enforceFocus:!0,hasBackdrop:!0,isOpen:!1,position:b.a.RIGHT,size:void 0,usePortal:!0}),n=Object(i.a)(t,2),c=n[0],s=n[1];return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(o.a,{onClick:function(){return s({isOpen:!0})},icon:"wrench",outlined:!0,intent:"warning",children:"What's happening ?"}),Object(O.jsx)(o.h,Object(r.a)(Object(r.a)({icon:"info-sign",onClose:function(){return s({isOpen:!1})},title:"What's happening ?"},c),{},{children:Object(O.jsx)("div",{className:j.a.DRAWER_BODY,children:Object(O.jsx)("div",{className:j.a.DIALOG_BODY,children:Object(O.jsx)("ul",{className:"list",children:e.map((function(e,t){return Object(O.jsx)("li",{children:e},t)}))})})})}))]})},F=function(){var e=Object(a.useState)({autoFocus:!0,canEscapeKeyClose:!0,canOutsideClickClose:!0,enforceFocus:!0,shouldReturnFocusOnClose:!0}),t=Object(i.a)(e,1)[0];return Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(o.o,{className:"bp3-dark",children:Object(O.jsxs)(o.q,{align:u.a.LEFT,children:[Object(O.jsx)(o.r,{children:"SCRAN.JS"}),Object(O.jsx)(o.p,{}),Object(O.jsx)("span",{children:"Analyze Single-cell RNA-seq Datasets"}),Object(O.jsx)(o.p,{}),Object(O.jsx)(x,Object(r.a)({icon:"document",title:"Import dataset and update parameters",buttonText:"Start Analysis",includeFooter:!0},t)),Object(O.jsx)(o.p,{}),Object(O.jsx)(v,{}),Object(O.jsx)(o.p,{}),Object(O.jsx)(g,{})]})})})},C=n(17),y=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){var n=null===e||void 0===e?void 0:e.data,a=null===e||void 0===e?void 0:e.width,c=null===e||void 0===e?void 0:e.color,s=null===e||void 0===e?void 0:e.ymax;if(s||(s=Math.max.apply(Math,Object(l.a)(n.map((function(e){return e.value}))))),a||(a=325),c||(c="#00B3A4"),!n)return"";var r=t.current;r.innerHTML="";var i=10,o=30,u=30,d=40,j=a-d-o,b=200-i-u,h=C.l(r).append("svg").attr("width",j+d+o).attr("height",b+i+u).append("g").attr("transform","translate(".concat(d,",").concat(i,")")),O=C.i().range([0,j]).domain(n.map((function(e){return e.key}))).padding(.2);h.append("g").attr("transform","translate(0,"+b+")").call(C.b(O)).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end");var f=C.j().domain([0,s]).range([b,0]);h.append("g").call(C.c(f)),h.selectAll("bars").data(n).enter().append("rect").attr("x",(function(e){return O(e.key)})).attr("y",(function(e){return f(e.value)})).attr("width",O.bandwidth()).attr("height",(function(e){return b-f(e.value)})).attr("fill",(function(e,t){return Array.isArray(c)?c[t]:c}))}),[]),Object(O.jsx)("div",{ref:t})},D=function(e){var t,n,a=null===e||void 0===e||null===(t=e.pca)||void 0===t?void 0:t.var_exp;if(!a)return"";var c=[];return null===(n=Object.values(a))||void 0===n||n.forEach((function(e,t){c.push({key:t+1,value:100*e})})),Object(O.jsx)(y,{data:c})},A=n(128),w=function(e){var t,n,c=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.clusters,s=Object(a.useContext)(f).setClusterColors,r=Object(a.useState)(null),l=Object(i.a)(r,2),o=l[0],u=l[1];if(Object(a.useEffect)((function(){var e=Object.keys(j).length,t=null;t=e>Object.keys(d).length?Object(A.randomColor)({luminosity:"dark",count:e+1}):d[e.toString()],u(t)}),[]),Object(a.useEffect)((function(){s(o)}),[o]),!c)return"";for(var d={1:["#1b9e77"],2:["#1b9e77","#d95f02"],3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},j={},b=0;b<(null===c||void 0===c?void 0:c.length);b++){var h=c[b];"CLUS_"+h in j?j["CLUS_"+h]++:j["CLUS_"+h]=0}var p=[];return null===(n=Object.values(j))||void 0===n||n.forEach((function(e,t){p.push({key:t+1,value:e})})),o&&Object(O.jsx)(y,{data:p,color:o})},N=n(33),E=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){var n=null===e||void 0===e?void 0:e.rdata,a=null===e||void 0===e?void 0:e.width,c=null===e||void 0===e?void 0:e.color;if(a||(a=275),c||(c="#00B3A4"),!n)return"";var s=t.current;s.innerHTML="";var r=10,l=30,i=30,o=40,u=a-o-l,d=200-r-i,j=C.l(s).append("svg").attr("width",u+o+l).attr("height",d+r+i).append("g").attr("transform","translate(".concat(o,",").concat(r,")")),b=C.j().domain(null===e||void 0===e?void 0:e.range).range([d,0]).nice();j.append("g").call(C.c(b));var h=C.i().range([0,u]).domain([null===e||void 0===e?void 0:e.label]).padding(.05);j.append("g").attr("transform","translate(0,"+d+")").call(C.b(h));var O=C.e().domain(b.domain()).thresholds(b.ticks(20)).value((function(e){return e}))(n),f=C.h(O,(function(e){return e.length})),p=C.j().range([0,h.bandwidth()]).domain([-f,f]),m=C.k().interpolator(C.f).domain(null===e||void 0===e?void 0:e.range);j.selectAll("violins").data([null===e||void 0===e?void 0:e.label]).enter().append("g").attr("transform",(function(e){return"translate("+h(e)+" ,0)"})).append("path").datum((function(){return O})).style("stroke","none").style("fill","#A7B6C2").attr("d",C.a().x0(p(0)).x1((function(e){return p(e.length)})).y((function(e){return b(e.x0)})).curve(C.d));j.selectAll("jitter").data(n).enter().append("circle").attr("cx",(function(t){return h(null===e||void 0===e?void 0:e.label)+h.bandwidth()/2-70*Math.random()})).attr("cy",(function(e){return b(e)})).attr("r",3).style("fill",(function(e){return m(e)})).attr("stroke","white"),j.selectAll("threshold").data([null===e||void 0===e?void 0:e.threshold]).enter().append("line").attr("transform",(function(){return"translate("+h(null===e||void 0===e?void 0:e.label)+" ,0)"})).attr("class","threshold").attr("x1",5).attr("y1",(function(e){return b(e)})).attr("x2",h.bandwidth()-5).attr("y2",(function(e){return b(e)})).attr("stroke-width",2).attr("stroke","Orange").on("mouseover",(function(){var e=C.l(this);e.attr("stroke","black"),e.attr("stroke-width","8")})).on("mouseout",(function(){var e=C.l(this);e.attr("stroke","Orange"),e.attr("stroke-width","5")}))}),[]),Object(O.jsx)("div",{ref:t})},S=(n(320),function(e){var t=e.data;return Object(O.jsx)("div",{className:"qc-plots",children:["sums","detected","proportion"].map((function(e){var n,a,c,s={threshold:null===t||void 0===t||null===(n=t.thresholds)||void 0===n?void 0:n[e],range:null===t||void 0===t||null===(a=t.ranges)||void 0===a?void 0:a[e],label:e,rdata:null===t||void 0===t||null===(c=t.data)||void 0===c?void 0:c[e]};return Object(O.jsx)("div",{children:Object(O.jsx)(E,Object(r.a)({},s))},e)}))})}),k=(n(321),function(){var e=Object(a.useContext)(f),t=e.pcaVarExp,n=e.qcData,c=e.clusterData;return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("div",{className:"gallery-cont",children:[c?Object(O.jsxs)(o.d,{className:"gallery-elem",elevation:N.a.ONE,children:[Object(O.jsx)("h5",{children:"# of cells per cluster"}),Object(O.jsx)(w,{data:c})]}):"",t?Object(O.jsxs)(o.d,{className:"gallery-elem",elevation:N.a.ONE,children:[Object(O.jsx)("h5",{children:"PCA (% variance explained)"}),Object(O.jsx)(D,{pca:t})]}):"",n&&(null===n||void 0===n?void 0:n.thresholds)?Object(O.jsxs)(o.d,{className:"gallery-elem",elevation:N.a.ONE,children:[Object(O.jsx)("h5",{children:"QC Statistics"}),Object(O.jsx)(S,{data:n})]}):""]})})}),B=n(72),T=function(e){var t=-Number.MAX_VALUE,n=Number.MAX_VALUE;return e.forEach((function(e){t<e&&(t=e),n>e&&(n=e)})),[n,t]};function R(){var e=null,t=0,n=100,a=["ff0000","ffff00","00ff00","0000ff"];function c(c){if(c.length<2)throw new Error("Rainbow must have two or more colours.");var s=(n-t)/(c.length-1),r=new M;r.setGradient(c[0],c[1]),r.setNumberRange(t,t+s),e=[r];for(var l=1;l<c.length-1;l++){var i=new M;i.setGradient(c[l],c[l+1]),i.setNumberRange(t+s*l,t+s*(l+1)),e[l]=i}a=c}c(a),this.setSpectrum=function(){return c(arguments),this},this.setSpectrumByArray=function(e){return c(e),this},this.colourAt=function(a){if(isNaN(a))throw new TypeError(a+" is not a number");if(1===e.length)return e[0].colourAt(a);var c=(n-t)/e.length,s=Math.min(Math.floor((Math.max(a,t)-t)/c),e.length-1);return e[s].colourAt(a)},this.colorAt=this.colourAt,this.setNumberRange=function(e,s){if(!(s>e))throw new RangeError("maxNumber ("+s+") is not greater than minNumber ("+e+")");return t=e,n=s,c(a),this}}function M(){var e="ff0000",t="0000ff",n=0,a=100;function c(e,t,c){var s=e;s<n&&(s=n),s>a&&(s=a);var r,l=a-n,i=parseInt(t,16),o=(parseInt(c,16)-i)/l,u=Math.round(o*(s-n)+i);return 1===(r=u.toString(16)).length?"0"+r:r}function s(e){if(function(e){return/^#?[0-9a-fA-F]{6}$/i.test(e)}(e))return e.substring(e.length-6,e.length);var t=e.toLowerCase();if(r.hasOwnProperty(t))return r[t];throw new Error(e+" is not a valid colour.")}this.setGradient=function(n,a){e=s(n),t=s(a)},this.setNumberRange=function(e,t){if(!(t>e))throw new RangeError("maxNumber ("+t+") is not greater than minNumber ("+e+")");n=e,a=t},this.colourAt=function(n){return c(n,e.substring(0,2),t.substring(0,2))+c(n,e.substring(2,4),t.substring(2,4))+c(n,e.substring(4,6),t.substring(4,6))};var r={aliceblue:"F0F8FF",antiquewhite:"FAEBD7",aqua:"00FFFF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"000000",blanchedalmond:"FFEBCD",blue:"0000FF",blueviolet:"8A2BE2",brown:"A52A2A",burlywood:"DEB887",cadetblue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerblue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"00FFFF",darkblue:"00008B",darkcyan:"008B8B",darkgoldenrod:"B8860B",darkgray:"A9A9A9",darkgreen:"006400",darkgrey:"A9A9A9",darkkhaki:"BDB76B",darkmagenta:"8B008B",darkolivegreen:"556B2F",darkorange:"FF8C00",darkorchid:"9932CC",darkred:"8B0000",darksalmon:"E9967A",darkseagreen:"8FBC8F",darkslateblue:"483D8B",darkslategray:"2F4F4F",darkslategrey:"2F4F4F",darkturquoise:"00CED1",darkviolet:"9400D3",deeppink:"FF1493",deepskyblue:"00BFFF",dimgray:"696969",dimgrey:"696969",dodgerblue:"1E90FF",firebrick:"B22222",floralwhite:"FFFAF0",forestgreen:"228B22",fuchsia:"FF00FF",gainsboro:"DCDCDC",ghostwhite:"F8F8FF",gold:"FFD700",goldenrod:"DAA520",gray:"808080",green:"008000",greenyellow:"ADFF2F",grey:"808080",honeydew:"F0FFF0",hotpink:"FF69B4",indianred:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderblush:"FFF0F5",lawngreen:"7CFC00",lemonchiffon:"FFFACD",lightblue:"ADD8E6",lightcoral:"F08080",lightcyan:"E0FFFF",lightgoldenrodyellow:"FAFAD2",lightgray:"D3D3D3",lightgreen:"90EE90",lightgrey:"D3D3D3",lightpink:"FFB6C1",lightsalmon:"FFA07A",lightseagreen:"20B2AA",lightskyblue:"87CEFA",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"B0C4DE",lightyellow:"FFFFE0",lime:"00FF00",limegreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumaquamarine:"66CDAA",mediumblue:"0000CD",mediumorchid:"BA55D3",mediumpurple:"9370DB",mediumseagreen:"3CB371",mediumslateblue:"7B68EE",mediumspringgreen:"00FA9A",mediumturquoise:"48D1CC",mediumvioletred:"C71585",midnightblue:"191970",mintcream:"F5FFFA",mistyrose:"FFE4E1",moccasin:"FFE4B5",navajowhite:"FFDEAD",navy:"000080",oldlace:"FDF5E6",olive:"808000",olivedrab:"6B8E23",orange:"FFA500",orangered:"FF4500",orchid:"DA70D6",palegoldenrod:"EEE8AA",palegreen:"98FB98",paleturquoise:"AFEEEE",palevioletred:"DB7093",papayawhip:"FFEFD5",peachpuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderblue:"B0E0E6",purple:"800080",red:"FF0000",rosybrown:"BC8F8F",royalblue:"4169E1",saddlebrown:"8B4513",salmon:"FA8072",sandybrown:"F4A460",seagreen:"2E8B57",seashell:"FFF5EE",sienna:"A0522D",silver:"C0C0C0",skyblue:"87CEEB",slateblue:"6A5ACD",slategray:"708090",slategrey:"708090",snow:"FFFAFA",springgreen:"00FF7F",steelblue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"FFFFFF",whitesmoke:"F5F5F5",yellow:"FFFF00",yellowgreen:"9ACD32"}}n(333);var I=function(){var e=Object(a.useRef)(),t=Object(a.useState)(null),n=Object(i.a)(t,2),c=n[0],s=n[1],r=Object(a.useState)(null),l=Object(i.a)(r,2),u=l[0],d=l[1],j=Object(a.useState)(!1),b=Object(i.a)(j,2),h=b[0],p=b[1],m=Object(a.useState)(null),x=Object(i.a)(m,2),v=x[0],g=x[1],F=Object(a.useContext)(f),C=F.plotRedDims,y=F.redDims,D=F.defaultRedDims,A=F.setDefaultRedDims,w=F.clusterData,N=F.tsneData,E=F.umapData,S=F.setPlotRedDims,k=F.clusterColors,M=F.gene,I=F.selectedClusterSummary;Object(a.useEffect)((function(){if(e.current){var t=c;if(!t){var n=e.current;n.style.width="95%",n.style.height="95%";(t=new B.ScatterGL(n,{orbitControls:{zoomSpeed:1.25},styles:{point:{scaleDefault:2.5,scaleSelected:2.5,scaleHover:2.5}}})).setPanMode(),s(t)}if(null===C||void 0===C?void 0:C.plot){var a=null===C||void 0===C?void 0:C.clusters,r=k,l=[];null===C||void 0===C||C.plot.x.forEach((function(e,t){l.push([e,null===C||void 0===C?void 0:C.plot.y[t]])}));var i={clusters:a},o=new B.ScatterGL.Dataset(l,i);t.render(o),t.setPointColorer((function(e,t,n){var c;if(null!=u&&u!==a[e])return"#D3D3D3";if(M&&Array.isArray(null===I||void 0===I||null===(c=I[M])||void 0===c?void 0:c.expr)){var s,l,i=T(I[M].expr),o=new R;o.setSpectrum("#F5F8FA","#2965CC");var d=0===i[1]?.01:i[1];return o.setNumberRange(0,d),g([0,d]),p(!0),"#"+o.colorAt(null===I||void 0===I||null===(s=I[M])||void 0===s||null===(l=s.expr)||void 0===l?void 0:l[e])}return p(!1),r[a[e]]}))}}}),[C,I,M,u]),Object(a.useEffect)((function(){_(D)}),[D]);var _=function(e){"TSNE"===D?S({plot:N,clusters:null===w||void 0===w?void 0:w.clusters}):"UMAP"===D&&S({plot:E,clusters:null===w||void 0===w?void 0:w.clusters})},P=function(e){"PAN"===e?c.setPanMode():"SELECT"===e&&c.setSelectMode()};return Object(O.jsxs)("div",{className:"scatter-plot",children:[Object(O.jsxs)(o.b,{style:{minWidth:75,minHeight:150},fill:!1,large:!1,minimal:!1,vertical:!0,className:"left-sidebar",children:[Object(O.jsxs)(o.a,{className:"dim-button",disabled:-1===y.indexOf("TSNE"),onClick:function(){return A("TSNE")},intent:"TSNE"===D?"primary":"",children:[Object(O.jsx)(o.l,{icon:"database"}),Object(O.jsx)("br",{}),Object(O.jsx)("span",{children:"TSNE"})]}),Object(O.jsxs)(o.a,{className:"dim-button",disabled:-1===y.indexOf("UMAP"),onClick:function(){return A("UMAP")},intent:"UMAP"===D?"primary":"",children:[Object(O.jsx)(o.l,{icon:"database"}),Object(O.jsx)("br",{}),Object(O.jsx)("span",{children:"UMAP"})]})]}),Object(O.jsxs)(o.f,{className:"top-header",fill:!1,vertical:!1,children:[Object(O.jsx)(o.a,{icon:"hand-up",onClick:function(e){return P("PAN")},children:"Pan"}),Object(O.jsx)(o.a,{icon:"widget",onClick:function(e){return P("SELECT")},children:"Selection"})]}),Object(O.jsx)("div",{className:"dim-plot",children:(null===C||void 0===C?void 0:C.plot)?Object(O.jsx)("div",{ref:e}):"Choose an Embedding... or Embeddings are being computed..."}),Object(O.jsx)("div",{className:"right-sidebar",children:h?Object(O.jsx)("div",{children:Object(O.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",children:[Object(O.jsx)("defs",{children:Object(O.jsxs)("linearGradient",{id:"geneGradient",gradientTransform:"rotate(90)",children:[Object(O.jsx)("stop",{offset:"5%","stop-color":"#F5F8FA"}),Object(O.jsx)("stop",{offset:"95%","stop-color":"#2965CC"})]})}),Object(O.jsx)("rect",{x:"25%",y:"25%",width:"13",height:"150",fill:"url('#geneGradient')"}),Object(O.jsx)("text",{x:"25%",y:"15%",style:{font:"8px sans-serif;"},children:M}),Object(O.jsx)("text",{x:"30%",y:"25%",style:{font:"8px sans-serif;"},children:v[0]}),Object(O.jsx)("text",{x:"30%",y:"100%",style:{font:"8px sans-serif;"},children:v[1].toFixed(2)})]})}):Object(O.jsx)(o.c,{title:"CLUSTERS",icon:"circle-arrow-left",children:Object(O.jsx)("ul",{children:null===k||void 0===k?void 0:k.map((function(e,t){return Object(O.jsxs)("li",{className:u==t?"legend-highlight":"",style:{color:e},onClick:function(){d(t===u?null:t)},children:[" Cluster ",t+1," "]},t)}))})})})]})},_=n(129),P=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){var n=null===e||void 0===e?void 0:e.data,a=null===e||void 0===e?void 0:e.width,c=null===e||void 0===e?void 0:e.color,s=null===e||void 0===e?void 0:e.clusters;if(a||(a=325),c||(c="#00B3A4"),!n)return"";var r=t.current;r.innerHTML="";var i=10,o=30,u=30,d=40,j=a-d-o,b=150-i-u,h=C.l(r).append("svg").attr("width",j+d+o).attr("height",b+i+u).append("g").attr("transform","translate(".concat(d,",").concat(i,")")),O=C.j().domain([0,Math.max.apply(Math,Object(l.a)(n))]).range([0,j]);h.append("g").attr("transform","translate(0, ".concat(b,")")).call(C.b(O));var f=C.e().value((function(e){return e})).domain(O.domain()).thresholds(O.ticks(25)),p=f(n),m=f(n.filter((function(e,t){return 0===(null===s||void 0===s?void 0:s[t])}))),x=f(n.filter((function(e,t){return 1===(null===s||void 0===s?void 0:s[t])}))),v=C.j().range([b,0]).domain([0,C.h(p,(function(e){return e.length}))]);h.selectAll("rectAll").data(m).join("rect").attr("x",1).attr("transform",(function(e){return"translate(".concat(O(e.x0)," , ").concat(v(e.length),")")})).attr("width",(function(e){return O(e.x1)-O(e.x0)-1})).attr("height",(function(e){return b-v(e.length)})).style("fill","#D3D3D3").style("opacity",.6),h.selectAll("rectCluster").data(x).enter().append("rect").attr("x",1).attr("transform",(function(e){return"translate(".concat(O(e.x0),", ").concat(v(e.length),")")})).attr("width",(function(e){return O(e.x1)-O(e.x0)-1})).attr("height",(function(e){return b-v(e.length)})).style("fill",c).style("opacity",.6),h.append("circle").attr("cx",j-50).attr("cy",5).attr("r",3).style("fill","#D3D3D3"),h.append("circle").attr("cx",j-50).attr("cy",15).attr("r",3).style("fill",c),h.append("text").attr("x",j-40).attr("y",5).text("all cells").style("font-size","10px").attr("alignment-baseline","middle"),h.append("text").attr("x",j-40).attr("y",15).text("this cluster").style("font-size","10px").attr("alignment-baseline","middle")}),[]),Object(O.jsx)("div",{ref:t})},q=(n(334),function(e){var t=Object(a.useRef)(),n=null===e||void 0===e?void 0:e.width,c=null===e||void 0===e?void 0:e.minmax,s=null===e||void 0===e?void 0:e.score,r=null===e||void 0===e?void 0:e.colorscale,l=null===e||void 0===e?void 0:e.colorscore,i=null===e||void 0===e?void 0:e.color,o=(s-c[0])/(c[1]-c[0]);return n||(n="100%"),i||(i="#00B3A4"),Object(O.jsx)("div",{ref:t,style:{width:n,height:"66%",margin:"5px",border:"1px solid gainsboro",alignItems:"center"},children:r?Object(O.jsx)("div",{style:{width:"".concat(100*l,"%"),backgroundColor:r(l),height:"100%"}}):Object(O.jsx)("div",{style:{width:"".concat(100*o,"%"),backgroundColor:i,height:"100%"}})})}),G=["children"],L=function(){var e=Object(a.useContext)(f),t=e.clusterData,n=e.selectedClusterSummary,c=e.setSelectedClusterSummary,s=e.selectedCluster,u=e.setSelectedCluster,j=e.setClusterRank,b=e.setReqGene,h=e.clusterColors,p=e.gene,m=e.setGene,x=Object(a.useState)(null),v=Object(i.a)(x,2),g=v[0],F=v[1],y=Object(a.useState)(null),D=Object(i.a)(y,2),A=D[0],w=D[1],N=Object(a.useState)(null),E=Object(i.a)(N,2),S=E[0],k=E[1],B=Object(a.useState)(null),R=Object(i.a)(B,2),M=R[0],I=R[1],L=Object(a.useState)(null),V=Object(i.a)(L,2),U=V[0],z=V[1],H=Object(a.useState)(null),W=Object(i.a)(H,2),Q=W[0],J=W[1],K=C.g,X=Object(a.useMemo)((function(){if(!n)return n;var e=Object.values(n),t=e.map((function(e){return null===e||void 0===e?void 0:e.mean}));I(T(t));var a=e.map((function(e){return null===e||void 0===e?void 0:e.delta}));z(T(a));var c=e.map((function(e){return null===e||void 0===e?void 0:e.lfc}));if(J(T(c)),0===e.length)return e;var s=Object(l.a)(e);return S&&""!==S?s=s.filter((function(e){return-1!==e.gene.toLowerCase().indexOf(S.toLowerCase())})):s}),[n,S]);return Object(a.useEffect)((function(){if(null===t||void 0===t?void 0:t.clusters){for(var e,n=Math.max.apply(Math,Object(l.a)(t.clusters)),a=[],c=0;c<n+1;c++)a.push(c+1);F(a),u(0);var s=[];null===t||void 0===t||null===(e=t.clusters)||void 0===e||e.forEach((function(e){return 0===e?s.push(1):s.push(0)})),w(s)}}),[t]),Object(a.useEffect)((function(){var e,n=[];null===t||void 0===t||null===(e=t.clusters)||void 0===e||e.forEach((function(e){return e===s?n.push(1):n.push(0)})),w(n)}),[s]),Object(O.jsxs)("div",{className:"marker-container",children:[Object(O.jsx)(o.j,{children:"Marker Genes"}),g?Object(O.jsx)("select",{onChange:function(e){var t;return u(parseInt(null===(t=e.currentTarget)||void 0===t?void 0:t.value.replace("Cluster ",""))-1)},children:g.map((function(e,t){return Object(O.jsxs)("option",{children:["Cluster ",e]},t)}))}):"",n?Object(O.jsxs)("div",{className:"marker-table",children:[Object(O.jsxs)("div",{className:"marker-header",children:[Object(O.jsx)(o.m,{leftIcon:"search",small:!0,placeholder:"Search gene...",type:"text",onChange:function(e){return k(e.target.value)}}),Object(O.jsxs)(o.n,{children:["sort by",Object(O.jsxs)("select",{onChange:function(e){j(e.currentTarget.value)},defaultValue:"cohen-min-rank",children:[Object(O.jsx)("option",{children:"cohen-min"}),Object(O.jsx)("option",{children:"cohen-mean"}),Object(O.jsx)("option",{children:"cohen-min-rank"}),Object(O.jsx)("option",{children:"auc-min"}),Object(O.jsx)("option",{children:"auc-mean"}),Object(O.jsx)("option",{children:"auc-min-rank"}),Object(O.jsx)("option",{children:"lfc-min"}),Object(O.jsx)("option",{children:"lfc-mean"}),Object(O.jsx)("option",{children:"lfc-min-rank"}),Object(O.jsx)("option",{children:"delta-d-min"}),Object(O.jsx)("option",{children:"delta-d-mean"}),Object(O.jsx)("option",{children:"delta-d-min-rank"})]})]})]}),Object(O.jsx)(_.a,{components:{Item:function(e){var t=e.children,n=Object(d.a)(e,G);return Object(O.jsx)("div",Object(r.a)(Object(r.a)({className:"row-card"},n),{},{children:t}))}},className:"marker-list",totalCount:X.length,itemContent:function(e){var t=X[e],a=t.expanded,l=t.expr;return Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"row-container",children:[Object(O.jsx)("span",{children:t.gene}),Object(O.jsx)(q,{minmax:Q,score:t.lfc,color:"#F5498B"}),Object(O.jsx)(q,{minmax:U,score:t.delta,color:"#4580E6"}),Object(O.jsx)(q,{minmax:M,score:t.mean,color:"#43BF4D"}),Object(O.jsx)(q,{minmax:[0,1],score:t.detected,color:K(t.detected)}),Object(O.jsxs)("div",{className:"row-action",children:[Object(O.jsx)(o.a,{icon:a?"minus":"plus",small:!0,fill:!1,className:"row-action",onClick:function(){var e=Object(r.a)({},n);e[t.gene].expanded=!e[t.gene].expanded,c(e),l||b(t.gene)}}),Object(O.jsx)(o.a,{small:!0,fill:!1,className:"row-action",onClick:function(){t.gene===p?m(null):(m(t.gene),l||b(t.gene))},children:Object(O.jsx)(o.l,{icon:"tint",color:t.gene===p?h[s]:""})})]})]}),Object(O.jsx)(o.e,{isOpen:a,children:A&&Object(O.jsx)(P,{data:l,color:h[s],clusters:A})})]})}}),Object(O.jsx)("div",{className:"marker-footer",children:Object(O.jsx)("p",{children:"Legend for bars"})})]}):""]})};var V=function(){var e=Object(a.useState)(!0),t=Object(i.a)(e,2),n=t[0],c=t[1],s=Object(a.useContext)(f),u=s.setWasmInitialized,d=s.setTsneData,j=s.setRedDims,b=s.redDims,h=s.setInitDims,p=s.setQcDims,m=s.defaultRedDims,x=s.setDefaultRedDims,v=s.setQcData,g=s.qcData,C=s.setClusterData,y=s.setFSelectionData,D=s.setUmapData,A=s.setPcaVarExp,w=s.logs,N=s.setLogs,E=s.selectedCluster,S=s.clusterRank,B=s.selectedClusterSummary,T=s.setSelectedClusterSummary,R=s.reqGene;return Object(a.useEffect)((function(){window.Worker.postMessage({type:"INIT",msg:"Initial Load"})}),[]),Object(a.useEffect)((function(){null!==E&&window.Worker.postMessage({type:"getMarkersForCluster",payload:{cluster:E,rank_type:S}})}),[E,S]),Object(a.useEffect)((function(){null!==R&&window.Worker.postMessage({type:"getGeneExpression",payload:{gene:R}})}),[R]),window.Worker.onmessage=function(e){var t=e.data;if(null===t||void 0===t?void 0:t.msg){var n=Object(l.a)(w),a=new Date;n.push("".concat(a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()," - ").concat(null===t||void 0===t?void 0:t.type," - ").concat(null===t||void 0===t?void 0:t.msg)),N(n)}if("INIT"===t.type)c(!1),u(!0);else if("input_DIMS"===t.type)h(t.resp);else if("quality_control_filtered_DIMS"===t.type)p(t.resp);else if("quality_control_metrics_DATA"===t.type){var s=t.resp;v(s)}else if("quality_control_thresholds_DATA"===t.type){var i=t.resp,o=Object(r.a)({},g);o.thresholds=i,v(o)}else if("feature_selection_DIMS"===t.type);else if("feature_selection_DATA"===t.type){var O=t.resp;y(O)}else if("pca_DATA"===t.type){var f=t.resp,F=Object(l.a)(b);F.push("PCA"),j(F),A(f)}else if("snn_cluster_graph_DATA"===t.type){var E=t.resp;C(E)}else if("tsne_DATA"===t.type||"tsne_iter"===t.type){var S=t.resp;d(S);var k=Object(l.a)(b);k.push("TSNE"),m||x("TSNE"),j(k)}else if("umap_DATA"===t.type){var R=t.resp;D(R);var M=Object(l.a)(b);M.push("UMAP"),j(M)}else if("markerGene_DATA"===t.type);else if("setMarkersForCluster"===t.type){var I=t.resp,_={};I.means.forEach((function(e,t){var n,a,c,s,r;_[null===I||void 0===I||null===(n=I.genes)||void 0===n?void 0:n[t]]={gene:null===I||void 0===I||null===(a=I.genes)||void 0===a?void 0:a[t],mean:e,delta:null===I||void 0===I||null===(c=I.delta_d)||void 0===c?void 0:c[t],lfc:null===I||void 0===I||null===(s=I.lfc)||void 0===s?void 0:s[t],detected:null===I||void 0===I||null===(r=I.detected)||void 0===r?void 0:r[t],expanded:!1,expr:null}})),T(_)}else if("setGeneExpression"===t.type){var P=t.resp,q=Object(r.a)({},B);q[P.gene].expr=Object.values(P.expr),T(q)}},Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)(F,{}),Object(O.jsxs)("div",{className:"App-content",children:[Object(O.jsx)("div",{className:"plot",children:Object(O.jsx)(I,{})}),Object(O.jsx)("div",{className:"marker",children:Object(O.jsx)(L,{})}),Object(O.jsx)("div",{className:"analysis",children:Object(O.jsx)(k,{})})]}),Object(O.jsx)(o.t,Object(r.a)(Object(r.a)({isOpen:n},{autoFocus:!0,canEscapeKeyClose:!1,canOutsideClickClose:!1,enforceFocus:!0,hasBackdrop:!0,usePortal:!0,useTallContent:!1}),{},{children:Object(O.jsxs)("div",{className:"spinner",children:[Object(O.jsx)(o.v,{size:100}),Object(O.jsx)("p",{children:"Initializing SCRAN.JS"})]})}))]})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,345)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))};s.a.render(Object(O.jsx)(p,{children:Object(O.jsx)(V,{})}),document.getElementById("root")),U()}},[[335,1,2]]]);
//# sourceMappingURL=main.9ab0d797.chunk.js.map