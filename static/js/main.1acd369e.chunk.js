(this["webpackJsonpscran.js"]=this["webpackJsonpscran.js"]||[]).push([[0],{287:function(e,t,n){},288:function(e,t,n){},290:function(e,t,n){},317:function(e,t,n){},318:function(e,t,n){},330:function(e,t,n){},331:function(e,t,n){},332:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(24),c=n.n(r),s=(n(287),n(4)),l=n(25),i=n(5),o=(n(288),n(340)),u=n(46),d=n(42),j=n(3),b=n(339),h=n(1),O=Object(a.createContext)(null),p=function(e){var t=e.children,n=Object(a.useState)({gene:null,mtx:null,barcode:null}),r=Object(i.a)(n,2),c=r[0],s=r[1],l=Object(a.useState)({qc:{"qc-nmads":3},fSelection:{"fsel-span":.3},pca:{"pca-npc":5,"pca-hvg":4e3},cluster:{"clus-k":10,"clus-res":.5,"clus-scheme":0,"clus-approx":!0,"clus-method":"snn_graph"},tsne:{"tsne-iter":500,"tsne-perp":30},umap:{"umap-nn":15,"umap-epochs":500,"umap-min_dist":.01},markerGene:{}}),o=Object(i.a)(l,2),u=o[0],d=o[1],j=Object(a.useState)(!1),b=Object(i.a)(j,2),p=b[0],m=b[1],f=Object(a.useState)(!1),x=Object(i.a)(f,2),v=x[0],g=x[1],F=Object(a.useState)(null),y=Object(i.a)(F,2),C=y[0],w=y[1],N=Object(a.useState)(null),k=Object(i.a)(N,2),A=k[0],D=k[1],E=Object(a.useState)(null),S=Object(i.a)(E,2),M=S[0],L=S[1],B=Object(a.useState)(null),T=Object(i.a)(B,2),R=T[0],I=T[1],_=Object(a.useState)(null),q=Object(i.a)(_,2),z=q[0],P=q[1],G=Object(a.useState)(null),U=Object(i.a)(G,2),V=U[0],W=U[1],H=Object(a.useState)(null),Q=Object(i.a)(H,2),J=Q[0],K=Q[1],Y=Object(a.useState)([]),X=Object(i.a)(Y,2),Z=X[0],$=X[1],ee=Object(a.useState)(null),te=Object(i.a)(ee,2),ne=te[0],ae=te[1],re=Object(a.useState)(null),ce=Object(i.a)(re,2),se=ce[0],le=ce[1],ie=Object(a.useState)(null),oe=Object(i.a)(ie,2),ue=oe[0],de=oe[1],je=Object(a.useState)(null),be=Object(i.a)(je,2),he=be[0],Oe=be[1],pe=Object(a.useState)({}),me=Object(i.a)(pe,2),fe=me[0],xe=me[1],ve=Object(a.useState)(null),ge=Object(i.a)(ve,2),Fe=ge[0],ye=ge[1],Ce=Object(a.useState)(null),we=Object(i.a)(Ce,2),Ne=we[0],ke=we[1],Ae=Object(a.useState)(null),De=Object(i.a)(Ae,2),Ee=De[0],Se=De[1],Me=Object(a.useState)(null),Le=Object(i.a)(Me,2),Be=Le[0],Te=Le[1],Re=Object(a.useState)(null),Ie=Object(i.a)(Re,2),_e=Ie[0],qe=Ie[1],ze=Object(a.useState)(null),Pe=Object(i.a)(ze,2),Ge=Pe[0],Ue=Pe[1],Ve=Object(a.useState)(null),We=Object(i.a)(Ve,2),He=We[0],Qe=We[1],Je=Object(a.useState)(null),Ke=Object(i.a)(Je,2),Ye=Ke[0],Xe=Ke[1],Ze=Object(a.useState)([]),$e=Object(i.a)(Ze,2),et=$e[0],tt=$e[1];return Object(a.useEffect)((function(){v&&null!=c.mtx&&window.Worker.postMessage({type:"RUN",payload:{files:[c.mtx,c.barcode?c.barcode[0]:[],c.gene?c.gene[0]:[]],params:u},msg:"not much to pass"})}),[c,u,v]),Object(h.jsx)(O.Provider,{value:{inputFiles:c,setInputFiles:s,params:u,setParams:d,error:C,setError:w,wasmInitialized:v,setWasmInitialized:g,pcaData:Ee,setPcaData:Se,pcaVarExp:Be,setPcaVarExp:Te,tsneData:_e,setTsneData:qe,umapData:Ge,setUmapData:Ue,initDims:A,setInitDims:D,qcDims:M,setQcDims:L,qcData:z,setQcData:P,qcThreshold:V,setQcThreshold:W,fSelDims:R,setFSelDims:I,redDims:Z,setRedDims:$,defaultRedDims:ne,setDefaultRedDims:ae,plotRedDims:se,setPlotRedDims:le,clusterData:ue,setClusterData:de,fSelectionData:J,setFSelectionData:K,logs:et,setLogs:tt,selectedCluster:he,setSelectedCluster:Oe,selectedClusterSummary:fe,setSelectedClusterSummary:xe,clusterRank:Ne,setClusterRank:ke,gene:He,setGene:Qe,clusterColors:Fe,setClusterColors:ye,reqGene:Ye,setReqGene:Xe,openInput:p,setOpenInput:m},children:t})},m=(n(290),["buttonText","includeFooter"]);var f=function(e){var t=e.buttonText,n=e.includeFooter,r=Object(d.a)(e,m),c=Object(a.useState)(!1),l=Object(i.a)(c,2),u=l[0],p=l[1],f=Object(a.useState)(null),x=Object(i.a)(f,2),v=x[0],g=x[1],F=Object(a.useCallback)((function(){return p(!u)}),[u]),y=Object(a.useCallback)((function(){return p(!1)}),[]),C=Object(a.useContext)(O),w=C.inputFiles,N=C.setInputFiles,k=C.params,A=C.setParams,D=C.openInput,E=Object(a.useState)(w),S=Object(i.a)(E,2),M=S[0],L=S[1],B=Object(a.useState)(k),T=Object(i.a)(B,2),R=T[0],I=T[1],_=Object(a.useState)({mtx:"Choose mtx file...",gene:"Choose gene file...",barcode:"Choose barcode file..."}),q=Object(i.a)(_,2),z=q[0],P=q[1];return Object(a.useEffect)((function(){D&&p(!0)}),[D]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(o.a,{onClick:F,icon:"social-media",intent:"primary",text:t}),Object(h.jsxs)(o.g,Object(s.a)(Object(s.a)({className:"analysis-dialog"},r),{},{isOpen:u,onClose:y,children:[Object(h.jsxs)("div",{className:j.a.DIALOG_BODY+" inputs-container",children:[Object(h.jsxs)("div",{className:"row-input",children:[Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("div",{children:[Object(h.jsxs)(o.k,{children:[Object(h.jsx)(o.z,{round:!0,children:"1"}),Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(1)},onMouseLeave:function(){return g(null)},children:"Load input files"})]}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)(o.o,{className:"row-input",children:Object(h.jsx)(o.i,{text:"Choose Matrix Market file",onInputChange:function(e){P(Object(s.a)(Object(s.a)({},z),{},{mtx:e.target.files[0].name})),L(Object(s.a)(Object(s.a)({},M),{},{mtx:e.target.files}))}})}),Object(h.jsx)(o.o,{className:"row-input",children:Object(h.jsx)(o.i,{text:"Choose feature annotation",onInputChange:function(e){P(Object(s.a)(Object(s.a)({},z),{},{gene:e.target.files[0].name})),L(Object(s.a)(Object(s.a)({},M),{},{gene:e.target.files}))}})}),Object(h.jsx)(o.o,{className:"row-input",children:Object(h.jsx)(o.i,{text:"Choose barcode annotation",onInputChange:function(e){P(Object(s.a)(Object(s.a)({},z),{},{barcode:e.target.files[0].name})),L(Object(s.a)(Object(s.a)({},M),{},{barcode:e.target.files}))}})})]})]})}),Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("div",{children:[Object(h.jsxs)(o.k,{children:[Object(h.jsx)(o.z,{round:!0,children:"2"}),Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(2)},onMouseLeave:function(){return g(null)},children:"Quality control"})]}),Object(h.jsx)("div",{className:"row",children:Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(2)},onMouseLeave:function(){return g(null)},children:"Number of MADs"})}),Object(h.jsx)(o.t,{placeholder:"3",value:R.qc["qc-nmads"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{qc:Object(s.a)(Object(s.a)({},R.qc),{},{"qc-nmads":e})}))}})]})})]})}),Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("div",{children:[Object(h.jsxs)(o.k,{children:[Object(h.jsx)(o.z,{round:!0,children:"3"}),Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(3)},onMouseLeave:function(){return g(null)},children:"Feature Selection"})]}),Object(h.jsx)("div",{className:"row",children:Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(3)},onMouseLeave:function(){return g(null)},children:"Lowess span"})}),Object(h.jsx)(o.t,{placeholder:"0.3",value:R.fSelection["fsel-span"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{fSelection:Object(s.a)(Object(s.a)({},R.fSelection),{},{"fsel-span":e})}))}})]})})]})}),Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("div",{children:[Object(h.jsxs)(o.k,{children:[Object(h.jsx)(o.z,{round:!0,children:"4"}),Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(4)},onMouseLeave:function(){return g(null)},children:"Principal components analysis"})]}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(4)},onMouseLeave:function(){return g(null)},children:"Number of HVGs"})}),Object(h.jsx)(o.t,{placeholder:"2500",value:R.pca["pca-hvg"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{pca:Object(s.a)(Object(s.a)({},R.pca),{},{"pca-hvg":e})}))}})]}),Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(4)},onMouseLeave:function(){return g(null)},children:"Number of PCs"})}),Object(h.jsx)(o.t,{placeholder:"25",value:R.pca["pca-npc"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{pca:Object(s.a)(Object(s.a)({},R.pca),{},{"pca-npc":e})}))}})]})]})]})}),Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("div",{children:[Object(h.jsxs)(o.k,{children:[Object(h.jsx)(o.z,{round:!0,children:"5"}),Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(5)},onMouseLeave:function(){return g(null)},children:"Clustering"})]}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(5)},onMouseLeave:function(){return g(null)},children:"Method"})}),Object(h.jsx)(o.l,{defaultValue:R.cluster["clus-method"],children:Object(h.jsx)("option",{children:R.cluster["clus-method"]})})]}),Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(5)},onMouseLeave:function(){return g(null)},children:"Number of neighbors"})}),Object(h.jsx)(o.t,{placeholder:"10",value:R.cluster["clus-k"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{cluster:Object(s.a)(Object(s.a)({},R.cluster),{},{"clus-k":e})}))}})]}),Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(5)},onMouseLeave:function(){return g(null)},children:"Use ANN"})}),Object(h.jsx)(o.y,{style:{marginTop:"10px"},large:!0,checked:R.cluster["clus-approx"],innerLabelChecked:"true",innerLabel:"false",onChange:function(e){I(Object(s.a)(Object(s.a)({},R),{},{cluster:Object(s.a)(Object(s.a)({},R.cluster),{},{"clus-approx":e.target.checked})}))}})]}),Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(5)},onMouseLeave:function(){return g(null)},children:"Weighting scheme"})}),Object(h.jsxs)(o.l,{onChange:function(e,t){var n;return I(Object(s.a)(Object(s.a)({},R),{},{cluster:Object(s.a)(Object(s.a)({},R.cluster),{},{"clus-scheme":parseInt(null===e||void 0===e||null===(n=e.currentTarget)||void 0===n?void 0:n.value)})}))},children:[Object(h.jsx)("option",{children:"Rank"},"0"),Object(h.jsx)("option",{children:"Number"},"1"),Object(h.jsx)("option",{children:"Jaccard"},"2")]})]}),Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(5)},onMouseLeave:function(){return g(null)},children:"Resolution"})}),Object(h.jsx)(o.t,{placeholder:"0.5",value:R.cluster["clus-res"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{cluster:Object(s.a)(Object(s.a)({},R.cluster),{},{"clus-res":e})}))}})]})]})]})}),Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("div",{children:[Object(h.jsxs)(o.k,{children:[Object(h.jsx)(o.z,{round:!0,children:"6"}),Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(6)},onMouseLeave:function(){return g(null)},children:"t-SNE"})]}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(6)},onMouseLeave:function(){return g(null)},children:"Perplexity"})}),Object(h.jsx)(o.t,{placeholder:"30",value:R.tsne["tsne-perp"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{tsne:Object(s.a)(Object(s.a)({},R.tsne),{},{"tsne-perp":e})}))}})]}),Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(6)},onMouseLeave:function(){return g(null)},children:"Iterations"})}),Object(h.jsx)(o.t,{placeholder:"500",value:R.tsne["tsne-iter"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{tsne:Object(s.a)(Object(s.a)({},R.tsne),{},{"tsne-iter":e})}))}})]})]})]})}),Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("div",{children:[Object(h.jsxs)(o.k,{children:[Object(h.jsx)(o.z,{round:!0,children:"7"}),Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(7)},onMouseLeave:function(){return g(null)},children:"UMAP"})]}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(7)},onMouseLeave:function(){return g(null)},children:"Number of neighbors"})}),Object(h.jsx)(o.t,{placeholder:"15",value:R.umap["umap-nn"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{umap:Object(s.a)(Object(s.a)({},R.umap),{},{"umap-nn":e})}))}})]}),Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(7)},onMouseLeave:function(){return g(null)},children:"Minimum distance"})}),Object(h.jsx)(o.t,{placeholder:"0.01",value:R.umap["umap-min_dist"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{umap:Object(s.a)(Object(s.a)({},R.umap),{},{"umap-min_dist":e})}))}})]}),Object(h.jsxs)(o.o,{className:"row-input",children:[Object(h.jsx)(o.A,{className:"text-100",children:Object(h.jsx)("span",{className:"row-tooltip",onMouseEnter:function(){return g(7)},onMouseLeave:function(){return g(null)},children:"Epochs"})}),Object(h.jsx)(o.t,{placeholder:"500",value:R.umap["umap-epoch"],onValueChange:function(e,t){I(Object(s.a)(Object(s.a)({},R),{},{umap:Object(s.a)(Object(s.a)({},R.umap),{},{"umap-epoch":e})}))}})]})]})]})})]}),Object(h.jsxs)("div",{className:"row-input-tooltips",children:[1==v&&Object(h.jsx)(o.c,{intent:"primary",children:Object(h.jsxs)("p",{children:["We currently support files in the Cellranger format - namely, a Matrix Market file containing the count matrix. We also recommend supplying the feature annotation (",Object(h.jsx)("code",{children:"features.tsv.gz"})," or ",Object(h.jsx)("code",{children:"genes.tsv.gz"}),"). Users may also provide a TSV file containing the barcode annotations, if any."]})}),2==v&&Object(h.jsxs)(o.c,{intent:"primary",children:[Object(h.jsx)("p",{children:"At this step, we compute per-cell quality control (QC) metrics such as the total count per cell, the total number of detected features and (if the feature annotation is supplied) the mitochondrial proportion in each cell."}),Object(h.jsx)("p",{children:"We remove low-quality cells based on these metrics - specifically, cells with low total counts/number of detected features or high mitochondrial proportions are filtered out."}),Object(h.jsx)("p",{children:"We use an outlier-based approach to define the filter threshold under the assumption that most cells in the dataset are of acceptable quality."}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Number of MADs"}),": Number of median absolute deviations (MADs) from the median, used to define a filter threshold in the appropriate direction for each QC metric. Increasing this value will reduce the stringency of the filtering."]})]}),3==v&&Object(h.jsxs)(o.c,{intent:"primary",children:[Object(h.jsx)("p",{children:"Identify highly variable genes while accounting for the mean-variance relationship. We do so by fitting a mean-dependent trend to the variances, computed from the log-transformed normalized expression values. The residuals from the trend are then used to rank highly variable genes."}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Lowess span"}),": The span of the LOWESS smoother for fitting the mean-variance trend. Larger values increase the smoothness of the global trend at the cost of decreasing sensitivity to local variations."]})]}),4==v&&Object(h.jsxs)(o.c,{intent:"primary",children:[Object(h.jsx)("p",{children:"Perform a principal components analysis (PCA) to obtain per-cell coordinates in a low-dimensional space. This is used to compact the data for faster downstream computation, as well as to remove uninteresting high-dimensional noise."}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Number of HVGs"}),": Number of highly variable genes to use to perform the PCA. Larger values will capture more biological signal at the cost of increasing noise and computational work."]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Number of PCs"}),": Number of principal components with the highest variance to retain in downstream analyses. Larger values will capture more biological signal at the cost of increasing noise and computational work."]})]}),5==v&&Object(h.jsxs)(o.c,{intent:"primary",children:[Object(h.jsx)("p",{children:"Cluster cells into discrete groupings based on their relative similarity in the low-dimensional space. The set of clusters serve as a summary of the cellular heterogeneity in the population, allowing us to easily perform further characterization on subpopulations of interest."}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Method"}),": Clustering algorithm to use. Currently, we use multi-level community detection on an shared nearest neighbor (SNN) graph where cells are the nodes and edges are created between neighboring cells."]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Number of neighbors"}),": Number of neighbors to use to construct the shared nearest neighbor graph. Larger values result in broader clusters."]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Use ANN ?"}),": Use an approximate method to speed up the nearest neighbor search. This sacrifices some accuracy for speed in larger datasets."]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Weighting scheme"}),": Weighting scheme to use for the edges of the shared nearest neighbor graph. The Rank approach derives a weight from the rank of the closest shared neighbor; the Number approach uses the number of shared neighbors; and the Jaccard approach uses the Jaccard index of the neighbor sets."]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Resolution"}),": Resolution parameter for the multi-level clustering, used to adjust the modularity calculation during community optimization. Larger values yield more fine-grained clusters."]})]}),6==v&&Object(h.jsxs)(o.c,{intent:"primary",children:[Object(h.jsx)("p",{children:"Create a t-SNE plot to visualize cells in two dimensions, because our feeble human minds cannot interpret high-dimensional spaces. Cells that were neighbors in the original space are kept close together in the 2D embedding, while dissimilar cells are placed (arbitrarily) far away."}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Perplexity"}),": Perplexity parameter, which determines the size of the neighborhood of each cell. Larger values will favor preservation of global structure in the 2D embedding."]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Iterations"}),": Number of t-SNE iterations. Doesn't usually have much of an effect if you leave it as it is."]})]}),7==v&&Object(h.jsxs)(o.c,{title:"Visually important content",intent:"primary",children:[Object(h.jsx)("p",{children:"Create a UMAP plot to visualize cells in two dimensions. Like the t-SNE, this aims to map cells from a high-dimensional space into a 2D embedding, where neighboring cells are kept close together and dissimilar cells are placed far apart."}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Number of neighbors"}),": Number of neighbors to use when defining the size of the local neighborhood. Larger values will favor preservation of global structure."]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Minimum distance"}),": Minimum distance between points. Smaller values result in more tightly packed embedding and favor local structure."]}),Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"Epochs"}),": Number of epochs to use for convergence. This doesn't really change all too much."]})]})]})]}),n?Object(h.jsx)("div",{className:j.a.DIALOG_FOOTER,children:Object(h.jsx)("div",{className:j.a.DIALOG_FOOTER_ACTIONS,children:Object(h.jsx)(b.a,{content:"Run Analysis",children:Object(h.jsx)(o.a,{icon:"function",onClick:function(){A(R),N(M),y()},children:"Analyze"})})})}):Object(h.jsx)("div",{style:{margin:"0 20px"}})]}))]})},x=function(){var e=Object(a.useContext)(O),t=e.initDims,n=e.qcDims;return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("span",{children:["Dataset Dims: ",t,n?" (After QC: ".concat(n,")"):" (After QC: ??? X ???)"]})})},v=n(19),g=function(){var e=Object(a.useContext)(O).logs,t=Object(a.useState)({autoFocus:!0,canEscapeKeyClose:!0,canOutsideClickClose:!0,enforceFocus:!0,hasBackdrop:!0,isOpen:!1,position:v.a.RIGHT,size:void 0,usePortal:!0}),n=Object(i.a)(t,2),r=n[0],c=n[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(o.a,{onClick:function(){return c({isOpen:!0})},icon:"wrench",outlined:!0,intent:"warning",children:"What's happening ?"}),Object(h.jsx)(o.h,Object(s.a)(Object(s.a)({icon:"info-sign",onClose:function(){return c({isOpen:!1})},title:"What's happening ?"},r),{},{children:Object(h.jsx)("div",{className:j.a.DRAWER_BODY,children:Object(h.jsx)("div",{className:j.a.DIALOG_BODY,children:Object(h.jsx)("ul",{className:"list",children:e.map((function(e,t){return Object(h.jsx)("li",{children:e},t)}))})})})}))]})},F=n(33),y=["buttonText","includeFooter"];var C=function(e){e.buttonText,e.includeFooter;var t=Object(d.a)(e,y),n=Object(a.useContext)(O).setOpenInput,r=Object(a.useState)(!0),c=Object(i.a)(r,2),l=c[0],u=c[1],p=Object(a.useState)(!1),m=Object(i.a)(p,2),f=m[0],x=m[1],v=Object(a.useCallback)((function(){u(!l),x(!0)}),[l]),g=Object(a.useCallback)((function(){return u(!1)}),[]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(o.a,{onClick:v,icon:"info-sign",intent:"primary",text:"Info"}),Object(h.jsxs)(o.g,Object(s.a)(Object(s.a)({},t),{},{isOpen:l,onClose:g,children:[Object(h.jsx)("div",{className:j.a.DIALOG_BODY,children:Object(h.jsxs)(o.d,{elevation:F.a.ZERO,children:[Object(h.jsxs)("p",{children:[Object(h.jsx)("strong",{children:"kana"})," performs a standard scRNA-seq data analysis directly inside the browser."]}),Object(h.jsxs)("p",{children:["With just a few clicks, you can get a UMAP/t-SNE and marker genes in an intuitive interface for further exploration. No need to transfer data, no need to install software, no need to configure a backend server - just point to a Matrix Market file and we'll analyze ",Object(h.jsx)("em",{children:"your"})," data on ",Object(h.jsx)("em",{children:"your"})," computer, no questions asked."]}),Object(h.jsxs)("p",{children:["Check out our ",Object(h.jsx)("a",{href:"https://github.com/jkanche/scran.js.app",target:"_blank",children:"GitHub page"})," for more details. Or you could just play around with the app to see what it can do - after all, it's totally free!"]}),Object(h.jsx)(o.k,{children:"Authors"}),"Jayaram Kancherla (",Object(h.jsx)("a",{href:"https://github.com/jkanche",target:"_blank",children:Object(h.jsx)("strong",{children:"@jkanche"})}),"), Aaron Lun (",Object(h.jsx)("a",{href:"https://github.com/LTLA",target:"_blank",children:Object(h.jsx)("strong",{children:"@LTLA"})}),")"]})}),Object(h.jsx)("div",{className:j.a.DIALOG_FOOTER,children:Object(h.jsx)("div",{className:j.a.DIALOG_FOOTER_ACTIONS,children:f?Object(h.jsx)(o.a,{icon:"cross",onClick:g,children:"Close"}):Object(h.jsx)(b.a,{content:"\u884c\u304f\u305e!",children:Object(h.jsx)(o.a,{icon:"bring-data",onClick:function(){n(!0),g()},children:"Get started"})})})})]}))]})},w=function(){var e=Object(a.useState)({autoFocus:!0,canEscapeKeyClose:!0,canOutsideClickClose:!0,enforceFocus:!0,shouldReturnFocusOnClose:!0}),t=Object(i.a)(e,1)[0];return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(o.p,{className:"bp3-dark",children:Object(h.jsxs)(o.r,{className:"navbar-group",align:u.a.LEFT,children:[Object(h.jsx)(o.s,{children:"SCRAN.JS"}),Object(h.jsx)(o.q,{}),Object(h.jsx)("span",{children:"Analyze Single-cell RNA-seq Datasets"}),Object(h.jsx)(o.q,{}),Object(h.jsx)(f,Object(s.a)({icon:"document",title:"Import dataset & update parameters (mouseover for more info)",buttonText:"Start Analysis",includeFooter:!0},t)),Object(h.jsx)(o.q,{}),Object(h.jsx)(x,{}),Object(h.jsx)(o.q,{}),Object(h.jsx)(g,{}),Object(h.jsx)(o.q,{}),Object(h.jsx)(C,{icon:"document",title:"Single-cell RNA-seq analysis in the browser",isOpen:!0})]})})})},N=n(12),k=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){var n=null===e||void 0===e?void 0:e.data,a=null===e||void 0===e?void 0:e.width,r=null===e||void 0===e?void 0:e.color,c=null===e||void 0===e?void 0:e.ymax;if(c||(c=Math.max.apply(Math,Object(l.a)(n.map((function(e){return e.value}))))),a||(a=325),r||(r="#00B3A4"),!n)return"";var s=t.current;s.innerHTML="";var i=10,o=30,u=30,d=40,j=a-d-o,b=200-i-u,h=N.n(s).append("svg").attr("width",j+d+o).attr("height",b+i+u).append("g").attr("transform","translate(".concat(d,",").concat(i,")")),O=N.k().range([0,j]).domain(n.map((function(e){return e.key}))).padding(.2);h.append("g").attr("transform","translate(0,"+b+")").call(N.b(O)).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end");var p=N.l().domain([0,c]).range([b,0]);h.append("g").call(N.c(p)),h.selectAll("bars").data(n).enter().append("rect").attr("x",(function(e){return O(e.key)})).attr("y",(function(e){return p(e.value)})).attr("width",O.bandwidth()).attr("height",(function(e){return b-p(e.value)})).attr("fill",(function(e,t){return Array.isArray(r)?r[t]:r}))}),[]),Object(h.jsx)("div",{ref:t})},A=function(e){var t,n,a=null===e||void 0===e||null===(t=e.pca)||void 0===t?void 0:t.var_exp;if(!a)return"";var r=[];return null===(n=Object.values(a))||void 0===n||n.forEach((function(e,t){r.push({key:t+1,value:100*e})})),Object(h.jsx)(k,{data:r})},D=n(129),E=function(e){var t,n,r=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.clusters,c=Object(a.useContext)(O).setClusterColors,s=Object(a.useState)(null),l=Object(i.a)(s,2),o=l[0],u=l[1];if(Object(a.useEffect)((function(){var e=Object.keys(j).length,t=null;t=e>Object.keys(d).length?Object(D.randomColor)({luminosity:"dark",count:e+1}):d[e.toString()],u(t)}),[]),Object(a.useEffect)((function(){c(o)}),[o]),!r)return"";for(var d={1:["#1b9e77"],2:["#1b9e77","#d95f02"],3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},j={},b=0;b<(null===r||void 0===r?void 0:r.length);b++){var p=r[b];"CLUS_"+p in j?j["CLUS_"+p]++:j["CLUS_"+p]=0}var m=[];return null===(n=Object.values(j))||void 0===n||n.forEach((function(e,t){m.push({key:t+1,value:e})})),o&&Object(h.jsx)(k,{data:m,color:o})},S=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){var n=null===e||void 0===e?void 0:e.rdata,a=null===e||void 0===e?void 0:e.width,r=null===e||void 0===e?void 0:e.color;if(a||(a=275),r||(r="#00B3A4"),!n)return"";var c=t.current;c.innerHTML="";var s=10,l=30,i=30,o=40,u=a-o-l,d=200-s-i,j=N.n(c).append("svg").attr("width",u+o+l).attr("height",d+s+i).append("g").attr("transform","translate(".concat(o,",").concat(s,")")),b=N.l().domain(null===e||void 0===e?void 0:e.range).range([d,0]).nice();j.append("g").call(N.c(b));var h=N.k().range([0,u]).domain([null===e||void 0===e?void 0:e.label]).padding(.05);j.append("g").attr("transform","translate(0,"+d+")").call(N.b(h));var O=N.f().domain(b.domain()).thresholds(b.ticks(20)).value((function(e){return e}))(n),p=N.j(O,(function(e){return e.length})),m=N.l().range([0,h.bandwidth()]).domain([-p,p]),f=N.m().interpolator(N.g).domain(null===e||void 0===e?void 0:e.range);j.selectAll("violins").data([null===e||void 0===e?void 0:e.label]).enter().append("g").attr("transform",(function(e){return"translate("+h(e)+" ,0)"})).append("path").datum((function(){return O})).style("stroke","none").style("fill","#A7B6C2").attr("d",N.a().x0(m(0)).x1((function(e){return m(e.length)})).y((function(e){return b(e.x0)})).curve(N.d));j.selectAll("jitter").data(n).enter().append("circle").attr("cx",(function(t){return h(null===e||void 0===e?void 0:e.label)+h.bandwidth()/2-70*Math.random()})).attr("cy",(function(e){return b(e)})).attr("r",3).style("fill",(function(e){return f(e)})).attr("stroke","white"),j.selectAll("threshold").data([null===e||void 0===e?void 0:e.threshold]).enter().append("line").attr("transform",(function(){return"translate("+h(null===e||void 0===e?void 0:e.label)+" ,0)"})).attr("class","threshold").attr("x1",5).attr("y1",(function(e){return b(e)})).attr("x2",h.bandwidth()-5).attr("y2",(function(e){return b(e)})).attr("stroke-width",2).attr("stroke","Orange").on("mouseover",(function(){var e=N.n(this);e.attr("stroke","black"),e.attr("stroke-width","8")})).on("mouseout",(function(){var e=N.n(this);e.attr("stroke","Orange"),e.attr("stroke-width","5")}))}),[]),Object(h.jsx)("div",{ref:t})},M=(n(317),function(e){var t=e.data;return Object(h.jsx)("div",{className:"qc-plots",children:["sums","detected","proportion"].map((function(e){var n,a,r,c={threshold:null===t||void 0===t||null===(n=t.thresholds)||void 0===n?void 0:n[e],range:null===t||void 0===t||null===(a=t.ranges)||void 0===a?void 0:a[e],label:e,rdata:null===t||void 0===t||null===(r=t.data)||void 0===r?void 0:r[e]};return Object(h.jsx)("div",{children:Object(h.jsx)(S,Object(s.a)({},c))},e)}))})}),L=(n(318),function(){var e=Object(a.useContext)(O),t=e.pcaVarExp,n=e.qcData,r=e.clusterData;return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"gallery-cont",children:[r?Object(h.jsxs)(o.d,{className:"gallery-elem",elevation:F.a.ONE,children:[Object(h.jsx)("h5",{children:"# of cells per cluster"}),Object(h.jsx)(E,{data:r})]}):"",t?Object(h.jsxs)(o.d,{className:"gallery-elem",elevation:F.a.ONE,children:[Object(h.jsx)("h5",{children:"PCA (% variance explained)"}),Object(h.jsx)(A,{pca:t})]}):"",n&&(null===n||void 0===n?void 0:n.thresholds)?Object(h.jsxs)(o.d,{className:"gallery-elem",elevation:F.a.ONE,children:[Object(h.jsx)("h5",{children:"QC Statistics"}),Object(h.jsx)(M,{data:n})]}):""]})})}),B=n(72),T=function(e){var t=-Number.MAX_VALUE,n=Number.MAX_VALUE;return e.forEach((function(e){t<e&&(t=e),n>e&&(n=e)})),[n,t]};function R(){var e=null,t=0,n=100,a=["ff0000","ffff00","00ff00","0000ff"];function r(r){if(r.length<2)throw new Error("Rainbow must have two or more colours.");var c=(n-t)/(r.length-1),s=new I;s.setGradient(r[0],r[1]),s.setNumberRange(t,t+c),e=[s];for(var l=1;l<r.length-1;l++){var i=new I;i.setGradient(r[l],r[l+1]),i.setNumberRange(t+c*l,t+c*(l+1)),e[l]=i}a=r}r(a),this.setSpectrum=function(){return r(arguments),this},this.setSpectrumByArray=function(e){return r(e),this},this.colourAt=function(a){if(isNaN(a))throw new TypeError(a+" is not a number");if(1===e.length)return e[0].colourAt(a);var r=(n-t)/e.length,c=Math.min(Math.floor((Math.max(a,t)-t)/r),e.length-1);return e[c].colourAt(a)},this.colorAt=this.colourAt,this.setNumberRange=function(e,c){if(!(c>e))throw new RangeError("maxNumber ("+c+") is not greater than minNumber ("+e+")");return t=e,n=c,r(a),this}}function I(){var e="ff0000",t="0000ff",n=0,a=100;function r(e,t,r){var c=e;c<n&&(c=n),c>a&&(c=a);var s,l=a-n,i=parseInt(t,16),o=(parseInt(r,16)-i)/l,u=Math.round(o*(c-n)+i);return 1===(s=u.toString(16)).length?"0"+s:s}function c(e){if(function(e){return/^#?[0-9a-fA-F]{6}$/i.test(e)}(e))return e.substring(e.length-6,e.length);var t=e.toLowerCase();if(s.hasOwnProperty(t))return s[t];throw new Error(e+" is not a valid colour.")}this.setGradient=function(n,a){e=c(n),t=c(a)},this.setNumberRange=function(e,t){if(!(t>e))throw new RangeError("maxNumber ("+t+") is not greater than minNumber ("+e+")");n=e,a=t},this.colourAt=function(n){return r(n,e.substring(0,2),t.substring(0,2))+r(n,e.substring(2,4),t.substring(2,4))+r(n,e.substring(4,6),t.substring(4,6))};var s={aliceblue:"F0F8FF",antiquewhite:"FAEBD7",aqua:"00FFFF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"000000",blanchedalmond:"FFEBCD",blue:"0000FF",blueviolet:"8A2BE2",brown:"A52A2A",burlywood:"DEB887",cadetblue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerblue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"00FFFF",darkblue:"00008B",darkcyan:"008B8B",darkgoldenrod:"B8860B",darkgray:"A9A9A9",darkgreen:"006400",darkgrey:"A9A9A9",darkkhaki:"BDB76B",darkmagenta:"8B008B",darkolivegreen:"556B2F",darkorange:"FF8C00",darkorchid:"9932CC",darkred:"8B0000",darksalmon:"E9967A",darkseagreen:"8FBC8F",darkslateblue:"483D8B",darkslategray:"2F4F4F",darkslategrey:"2F4F4F",darkturquoise:"00CED1",darkviolet:"9400D3",deeppink:"FF1493",deepskyblue:"00BFFF",dimgray:"696969",dimgrey:"696969",dodgerblue:"1E90FF",firebrick:"B22222",floralwhite:"FFFAF0",forestgreen:"228B22",fuchsia:"FF00FF",gainsboro:"DCDCDC",ghostwhite:"F8F8FF",gold:"FFD700",goldenrod:"DAA520",gray:"808080",green:"008000",greenyellow:"ADFF2F",grey:"808080",honeydew:"F0FFF0",hotpink:"FF69B4",indianred:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderblush:"FFF0F5",lawngreen:"7CFC00",lemonchiffon:"FFFACD",lightblue:"ADD8E6",lightcoral:"F08080",lightcyan:"E0FFFF",lightgoldenrodyellow:"FAFAD2",lightgray:"D3D3D3",lightgreen:"90EE90",lightgrey:"D3D3D3",lightpink:"FFB6C1",lightsalmon:"FFA07A",lightseagreen:"20B2AA",lightskyblue:"87CEFA",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"B0C4DE",lightyellow:"FFFFE0",lime:"00FF00",limegreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumaquamarine:"66CDAA",mediumblue:"0000CD",mediumorchid:"BA55D3",mediumpurple:"9370DB",mediumseagreen:"3CB371",mediumslateblue:"7B68EE",mediumspringgreen:"00FA9A",mediumturquoise:"48D1CC",mediumvioletred:"C71585",midnightblue:"191970",mintcream:"F5FFFA",mistyrose:"FFE4E1",moccasin:"FFE4B5",navajowhite:"FFDEAD",navy:"000080",oldlace:"FDF5E6",olive:"808000",olivedrab:"6B8E23",orange:"FFA500",orangered:"FF4500",orchid:"DA70D6",palegoldenrod:"EEE8AA",palegreen:"98FB98",paleturquoise:"AFEEEE",palevioletred:"DB7093",papayawhip:"FFEFD5",peachpuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderblue:"B0E0E6",purple:"800080",red:"FF0000",rosybrown:"BC8F8F",royalblue:"4169E1",saddlebrown:"8B4513",salmon:"FA8072",sandybrown:"F4A460",seagreen:"2E8B57",seashell:"FFF5EE",sienna:"A0522D",silver:"C0C0C0",skyblue:"87CEEB",slateblue:"6A5ACD",slategray:"708090",slategrey:"708090",snow:"FFFAFA",springgreen:"00FF7F",steelblue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"FFFFFF",whitesmoke:"F5F5F5",yellow:"FFFF00",yellowgreen:"9ACD32"}}n(330);var _=function(){var e,t=Object(a.useRef)(),n=Object(a.useState)(null),r=Object(i.a)(n,2),c=r[0],s=r[1],u=Object(a.useState)(null),d=Object(i.a)(u,2),j=d[0],b=d[1],p=Object(a.useState)(!1),m=Object(i.a)(p,2),f=m[0],x=m[1],v=Object(a.useState)(null),g=Object(i.a)(v,2),F=g[0],y=g[1],C=Object(a.useState)(F),w=Object(i.a)(C,2),N=w[0],k=w[1],A=Object(a.useState)(null),D=Object(i.a)(A,2),E=D[0],S=D[1],M=Object(a.useContext)(O),L=M.plotRedDims,I=M.redDims,_=M.defaultRedDims,q=M.setDefaultRedDims,z=M.clusterData,P=M.tsneData,G=M.umapData,U=M.setPlotRedDims,V=M.clusterColors,W=M.gene,H=M.selectedClusterSummary;Object(a.useEffect)((function(){var e;if(W&&""!=W||x(!1),null===H||void 0===H||null===(e=H[W])||void 0===e?void 0:e.expr){var t,n=T(null===H||void 0===H||null===(t=H[W])||void 0===t?void 0:t.expr),a=0===n[1]?.01:n[1],r=new R;r.setSpectrum("#F5F8FA","#2965CC"),r.setNumberRange(0,a),x(!0),S(r),k([0,a]),y([0,a])}}),[null===H||void 0===H||null===(e=H[W])||void 0===e?void 0:e.expr],W),Object(a.useEffect)((function(){if(Array.isArray(N)){var e=new R;e.setSpectrum("#F5F8FA","#2965CC"),e.setNumberRange.apply(e,Object(l.a)(N)),S(e),x(!0)}}),[N]),Object(a.useEffect)((function(){if(t.current){var e=c;if(!e){var n=t.current;n.style.width="95%",n.style.height="95%";(e=new B.ScatterGL(n,{orbitControls:{zoomSpeed:1.25},styles:{point:{scaleDefault:2.5,scaleSelected:2.5,scaleHover:2.5}}})).setPanMode(),s(e)}if(null===L||void 0===L?void 0:L.plot){var a=null===L||void 0===L?void 0:L.clusters,r=V,l=[];null===L||void 0===L||L.plot.x.forEach((function(e,t){l.push([e,null===L||void 0===L?void 0:L.plot.y[t]])}));var i={clusters:a},o=new B.ScatterGL.Dataset(l,i);e.render(o),e.setPointColorer((function(e,t,n){var c,s,l;return null!=j&&j!==a[e]?"#D3D3D3":W&&Array.isArray(null===H||void 0===H||null===(c=H[W])||void 0===c?void 0:c.expr)?(x(!0),"#"+E.colorAt(null===H||void 0===H||null===(s=H[W])||void 0===s||null===(l=s.expr)||void 0===l?void 0:l[e])):(x(!1),r[a[e]])}))}}}),[L,E,j]),Object(a.useEffect)((function(){Q(_)}),[_]);var Q=function(e){"TSNE"===_?U({plot:P,clusters:null===z||void 0===z?void 0:z.clusters}):"UMAP"===_&&U({plot:G,clusters:null===z||void 0===z?void 0:z.clusters})},J=function(e){"PAN"===e?c.setPanMode():"SELECT"===e&&c.setSelectMode()};return Object(h.jsxs)("div",{className:"scatter-plot",children:[Object(h.jsxs)(o.b,{style:{minWidth:75,minHeight:150},fill:!1,large:!1,minimal:!1,vertical:!0,className:"left-sidebar",children:[Object(h.jsxs)(o.a,{className:"dim-button",disabled:-1===I.indexOf("TSNE"),onClick:function(){return q("TSNE")},intent:"TSNE"===_?"primary":"",children:[Object(h.jsx)(o.m,{icon:"database"}),Object(h.jsx)("br",{}),Object(h.jsx)("span",{children:"TSNE"})]}),Object(h.jsxs)(o.a,{className:"dim-button",disabled:-1===I.indexOf("UMAP"),onClick:function(){return q("UMAP")},intent:"UMAP"===_?"primary":"",children:[Object(h.jsx)(o.m,{icon:"database"}),Object(h.jsx)("br",{}),Object(h.jsx)("span",{children:"UMAP"})]})]}),Object(h.jsxs)(o.f,{className:"top-header",fill:!1,vertical:!1,children:[Object(h.jsx)(o.a,{icon:"hand-up",onClick:function(e){return J("PAN")},children:"Pan"}),Object(h.jsx)(o.a,{icon:"widget",onClick:function(e){return J("SELECT")},children:"Selection"})]}),Object(h.jsx)("div",{className:"dim-plot",children:(null===L||void 0===L?void 0:L.plot)?Object(h.jsx)("div",{ref:t}):"Choose an Embedding... or Embeddings are being computed..."}),Object(h.jsx)("div",{className:"right-sidebar",children:Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:"right-sidebar-cluster",children:[Object(h.jsx)(o.c,{title:"CLUSTERS",icon:"circle-arrow-left"}),Object(h.jsx)("ul",{children:null===V||void 0===V?void 0:V.map((function(e,t){return Object(h.jsxs)("li",{className:j==t?"legend-highlight":"",style:{color:e},onClick:function(){b(t===j?null:t)},children:[" Cluster ",t+1," "]},t)}))})]}),f?Object(h.jsxs)("div",{className:"right-sidebar-slider",children:[Object(h.jsx)(o.c,{intent:"primary",style:{textAlign:"left"},children:"Use the slider to adjust the color gradient of the plot. Useful when data is skewed by either a few lowly or highly expressed cells"}),Object(h.jsxs)("div",{className:"dim-slider-container",children:[Object(h.jsxs)("div",{className:"dim-slider-gradient",children:[Object(h.jsx)("span",{children:Math.round(F[0])}),"\xa0",Object(h.jsx)("div",{style:{backgroundImage:"linear-gradient(to right, #F5F8FA ".concat(100*(N[0]-F[0])/(F[1]-F[0]),"%, ").concat(100*(N[1]+N[0]-2*F[0])/(2*(F[1]-F[0])),"%, #2965CC ").concat(100-100*(F[1]-N[1])/(F[1]-F[0]),"%)"),width:"175px",height:"15px"}}),"\xa0",Object(h.jsx)("span",{children:Math.round(F[1])})]}),Object(h.jsx)("div",{className:"dim-range-slider",children:Object(h.jsx)(o.w,{min:Math.round(F[0]),max:Math.round(F[1]),stepSize:Math.round(F[1]-F[0])/25,onChange:function(e){k(e)},value:[Math.round(N[0]),Math.round(N[1])],vertical:!1})})]})]}):""]})})]})},q=n(130),z=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){var n=null===e||void 0===e?void 0:e.data,a=null===e||void 0===e?void 0:e.width,r=null===e||void 0===e?void 0:e.color,c=null===e||void 0===e?void 0:e.clusters;if(a||(a=325),r||(r="#00B3A4"),!n)return"";var s=t.current;s.innerHTML="";var i=10,o=30,u=30,d=40,j=a-d-o,b=150-i-u,h=N.n(s).append("svg").attr("width",j+d+o).attr("height",b+i+u).append("g").attr("transform","translate(".concat(d,",").concat(i,")")),O=N.l().domain([0,Math.max.apply(Math,Object(l.a)(n))]).range([0,j]);h.append("g").attr("transform","translate(0, ".concat(b,")")).call(N.b(O));var p=N.f().value((function(e){return e})).domain(O.domain()).thresholds(O.ticks(25)),m=p(n),f=p(n.filter((function(e,t){return 0===(null===c||void 0===c?void 0:c[t])}))),x=p(n.filter((function(e,t){return 1===(null===c||void 0===c?void 0:c[t])}))),v=N.l().range([b,0]).domain([0,N.j(m,(function(e){return e.length}))]);h.selectAll("rectAll").data(f).join("rect").attr("x",1).attr("transform",(function(e){return"translate(".concat(O(e.x0)," , ").concat(v(e.length),")")})).attr("width",(function(e){return O(e.x1)-O(e.x0)-1})).attr("height",(function(e){return b-v(e.length)})).style("fill","#D3D3D3").style("opacity",.6),h.selectAll("rectCluster").data(x).enter().append("rect").attr("x",1).attr("transform",(function(e){return"translate(".concat(O(e.x0),", ").concat(v(e.length),")")})).attr("width",(function(e){return O(e.x1)-O(e.x0)-1})).attr("height",(function(e){return b-v(e.length)})).style("fill",r).style("opacity",.6),h.append("circle").attr("cx",j-50).attr("cy",5).attr("r",3).style("fill","#D3D3D3"),h.append("circle").attr("cx",j-50).attr("cy",15).attr("r",3).style("fill",r),h.append("text").attr("x",j-40).attr("y",5).text("all cells").style("font-size","10px").attr("alignment-baseline","middle"),h.append("text").attr("x",j-40).attr("y",15).text("this cluster").style("font-size","10px").attr("alignment-baseline","middle")}),[]),Object(h.jsx)("div",{ref:t})},P=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){var n=null===e||void 0===e?void 0:e.data,a=null===e||void 0===e?void 0:e.width,r=null===e||void 0===e?void 0:e.height,c=null===e||void 0===e?void 0:e.color;if(a||(a=325),r||(r=150),c||(c="#00B3A4"),!n)return"";var s=t.current;s.innerHTML="";var i=5,o=5,u=5,d=5,j=a-d-o,b=r-i-u,h=N.n(s).append("svg").attr("width",j+d+o).attr("height",b+i+u).append("g").attr("transform","translate(".concat(d,",").concat(i,")")),O=N.l().domain([0,Math.max.apply(Math,Object(l.a)(n))]).range([0,j]);h.append("g").attr("transform","translate(0, ".concat(b,")")).call(N.b(O));var p=N.f().value((function(e){return e})).domain(O.domain()).thresholds(O.ticks(25))(n),m=N.l().range([b,0]);m.domain([0,N.j(p,(function(e){return e.length}))]),h.selectAll("rect").data(p).join("rect").attr("x",1).attr("transform",(function(e){return"translate(".concat(O(e.x0)," , ").concat(m(e.length),")")})).attr("width",(function(e){return O(e.x1)-O(e.x0)-1})).attr("height",(function(e){return b-m(e.length)})).style("fill",c)}),[null===e||void 0===e?void 0:e.data]),Object(h.jsx)("div",{ref:t})},G=function(e){var t=Object(a.useRef)(),n=null===e||void 0===e?void 0:e.width,r=null===e||void 0===e?void 0:e.minmax,c=null===e||void 0===e?void 0:e.score,s=null===e||void 0===e?void 0:e.colorscale,l=null===e||void 0===e?void 0:e.colorscore,i=null===e||void 0===e?void 0:e.color,o=(c-r[0])/(r[1]-r[0]);return n||(n="100%"),i||(i="#00B3A4"),Object(h.jsx)("div",{ref:t,style:{width:n,height:"66%",margin:"5px",border:"1px solid gainsboro",alignItems:"center"},children:s?Object(h.jsx)("div",{style:{width:"".concat(100*l,"%"),backgroundColor:s(l),height:"100%"}}):Object(h.jsx)("div",{style:{width:"".concat(100*o,"%"),backgroundColor:i,height:"100%"}})})},U=function(e){var t=Object(a.useRef)(),n=null===e||void 0===e?void 0:e.width,r=(null===e||void 0===e||e.colorscale,null===e||void 0===e?void 0:e.score),c=null===e||void 0===e?void 0:e.minmax,s=N.m(N.i).domain([c[1],c[0]]);return n||(n="100%"),Object(h.jsx)("div",{ref:t,style:{width:n,height:"66%",margin:"5px",border:"1px solid gainsboro",alignItems:"center",backgroundColor:s(r)},children:Object(h.jsx)("div",{style:{width:"100%",backgroundColor:s(r),height:"100%"}})})},V=(n(331),["children"]),W=function(){var e=Object(a.useContext)(O),t=e.clusterData,n=e.selectedClusterSummary,r=e.setSelectedClusterSummary,c=e.selectedCluster,u=e.setSelectedCluster,j=e.setClusterRank,p=e.setReqGene,m=e.clusterColors,f=e.gene,x=e.setGene,v=Object(a.useState)(null),g=Object(i.a)(v,2),F=g[0],y=g[1],C=Object(a.useState)(null),w=Object(i.a)(C,2),k=w[0],A=w[1],D=Object(a.useState)(null),E=Object(i.a)(D,2),S=E[0],M=E[1],L=Object(a.useState)(null),B=Object(i.a)(L,2),T=B[0],R=B[1],I=Object(a.useState)(null),_=Object(i.a)(I,2),W=_[0],H=_[1],Q=Object(a.useState)(null),J=Object(i.a)(Q,2),K=J[0],Y=J[1],X=Object(a.useState)(null),Z=Object(i.a)(X,2),$=Z[0],ee=Z[1],te=Object(a.useState)(null),ne=Object(i.a)(te,2),ae=ne[0],re=ne[1],ce=Object(a.useState)(null),se=Object(i.a)(ce,2),le=se[0],ie=se[1],oe=Object(a.useState)(null),ue=Object(i.a)(oe,2),de=ue[0],je=ue[1],be=Object(a.useState)(null),he=Object(i.a)(be,2),Oe=he[0],pe=he[1],me=Object(a.useState)(null),fe=Object(i.a)(me,2),xe=fe[0],ve=fe[1],ge=Object(a.useState)({}),Fe=Object(i.a)(ge,2),ye=Fe[0],Ce=Fe[1],we=Object(a.useState)(null),Ne=Object(i.a)(we,2),ke=Ne[0],Ae=Ne[1],De=Object(a.useState)(null),Ee=Object(i.a)(De,2),Se=(Ee[0],Ee[1],Object(a.useState)(null)),Me=Object(i.a)(Se,2),Le=(Me[0],Me[1],N.i);Object(a.useEffect)((function(){if(!n)return n;var e=Object.values(n);if(0===e.length)return e;var t=e.map((function(e){return null===e||void 0===e?void 0:e.mean})),a=N.e(t),r=0===a[1]?.01:a[1];R([parseFloat(a[0].toFixed(2)),parseFloat(r.toFixed(2))]),ie(t);var c=e.map((function(e){return null===e||void 0===e?void 0:e.delta})),s=N.e(c),i=0===s[1]?.01:s[1];H([parseFloat(s[0].toFixed(2)),parseFloat(i.toFixed(2))]),je(c);var o=e.map((function(e){return null===e||void 0===e?void 0:e.lfc})),u=N.e(o),d=0===u[1]?.01:u[1];Y([parseFloat(u[0].toFixed(2)),parseFloat(d.toFixed(2))]),pe(o);var j=e.map((function(e){return null===e||void 0===e?void 0:e.detected})),b=N.e(j),h=0===b[1]?.01:b[1];ee([parseFloat(b[0].toFixed(2)),parseFloat(h.toFixed(2))]),ve(j),re({lfc:[parseFloat(u[0].toFixed(2)),parseFloat(d.toFixed(2))],mean:[parseFloat(a[0].toFixed(2)),parseFloat(r.toFixed(2))],detected:[parseFloat(b[0].toFixed(2)),parseFloat(h.toFixed(2))],delta:[parseFloat(s[0].toFixed(2)),parseFloat(i.toFixed(2))]});var O=Object(l.a)(e);Ae(O)}),[n]);var Be=Object(a.useMemo)((function(){if(!ke)return[];var e=ke;if(ye){var t=function(t){var n=ye[t];if(n[0]==ae[t][0]&&n[1]==ae[t][1])return"continue";e=e.filter((function(e){return e[t]>=n[0]&&e[t]<=n[1]}))};for(var n in ye)t(n)}return S&&""!==S?e=e.filter((function(e){return-1!==e.gene.toLowerCase().indexOf(S.toLowerCase())})):e}),[ke,S,ye]);Object(a.useEffect)((function(){if(null===t||void 0===t?void 0:t.clusters){for(var e,n=Math.max.apply(Math,Object(l.a)(t.clusters)),a=[],r=0;r<n+1;r++)a.push(r+1);y(a),u(0);var c=[];null===t||void 0===t||null===(e=t.clusters)||void 0===e||e.forEach((function(e){return 0===e?c.push(1):c.push(0)})),A(c)}}),[t]),Object(a.useEffect)((function(){var e,n=[];null===t||void 0===t||null===(e=t.clusters)||void 0===e||e.forEach((function(e){return e===c?n.push(1):n.push(0)})),A(n)}),[c]);var Te=function(e,t){var n=Object(s.a)({},ye);n[t]=e,Ce(n)};return Object(h.jsxs)("div",{className:"marker-container",children:[Object(h.jsx)(o.j,{children:"Marker Genes"}),F?Object(h.jsx)("select",{onChange:function(e){var t;u(parseInt(null===(t=e.currentTarget)||void 0===t?void 0:t.value.replace("Cluster ",""))-1),x(null)},children:F.map((function(e,t){return Object(h.jsxs)("option",{children:["Cluster ",e]},t)}))}):"",n?Object(h.jsxs)("div",{className:"marker-table",children:[Object(h.jsxs)("div",{className:"marker-header",children:[Object(h.jsx)(o.n,{leftIcon:"search",small:!0,placeholder:"Search gene...",type:"text",onChange:function(e){return M(e.target.value)}}),Object(h.jsxs)(o.o,{children:["sort by \xa0",Object(h.jsxs)("select",{onChange:function(e){j(e.currentTarget.value)},defaultValue:"cohen-min-rank",children:[Object(h.jsx)("option",{children:"cohen-min"}),Object(h.jsx)("option",{children:"cohen-mean"}),Object(h.jsx)("option",{children:"cohen-min-rank"}),Object(h.jsx)("option",{children:"auc-min"}),Object(h.jsx)("option",{children:"auc-mean"}),Object(h.jsx)("option",{children:"auc-min-rank"}),Object(h.jsx)("option",{children:"lfc-min"}),Object(h.jsx)("option",{children:"lfc-mean"}),Object(h.jsx)("option",{children:"lfc-min-rank"}),Object(h.jsx)("option",{children:"delta-d-min"}),Object(h.jsx)("option",{children:"delta-d-mean"}),Object(h.jsx)("option",{children:"delta-d-min-rank"})]})]})]}),Object(h.jsx)(q.a,{components:{Item:function(e){var t=e.children,n=Object(d.a)(e,V);return Object(h.jsx)("div",Object(s.a)(Object(s.a)({className:"row-card"},n),{},{children:t}))},Header:function(){return Object(h.jsxs)("div",{className:"row-container row-header",children:[Object(h.jsx)("span",{children:"Gene"}),Object(h.jsx)("span",{children:"Log-FC"}),Object(h.jsx)("span",{children:"\u0394-detected"}),Object(h.jsxs)("span",{children:["Expression \xa0",Object(h.jsx)(b.a,{content:"bar represents the mean expression of the gene and the color gradient represents detected.",openOnTargetFocus:!1,children:Object(h.jsx)(o.m,{size:12,icon:"help"})})]}),Object(h.jsx)("span",{})]})}},className:"marker-list",totalCount:Be.length,itemContent:function(e){var t=Be[e],a=t.expanded,l=t.expr;return Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:"row-container",children:[Object(h.jsx)("span",{children:t.gene}),Object(h.jsx)(U,{minmax:K,colorscale:N.h,score:t.lfc}),Object(h.jsx)(U,{minmax:W,colorscale:N.h,score:t.delta}),Object(h.jsx)(G,{minmax:T,colorscale:Le,score:t.mean,colorscore:t.detected}),Object(h.jsxs)("div",{className:"row-action",children:[Object(h.jsx)(o.a,{icon:a?"minus":"plus",small:!0,fill:!1,className:"row-action",onClick:function(){var e=Object(s.a)({},n);e[t.gene].expanded=!e[t.gene].expanded,r(e),l||p(t.gene)}}),Object(h.jsx)(o.a,{small:!0,fill:!1,className:"row-action",onClick:function(){t.gene===f?x(null):(x(t.gene),l||p(t.gene))},children:Object(h.jsx)(o.m,{icon:"tint",color:t.gene===f?m[c]:""})})]})]}),Object(h.jsx)(o.e,{isOpen:a,children:k&&Object(h.jsx)(z,{data:l,color:m[c],clusters:k})})]})}}),Object(h.jsxs)("div",{className:"marker-footer",children:[Object(h.jsx)(o.k,{className:"marker-footer-title",children:"Filter Markers"}),Object(h.jsxs)("div",{className:"marker-filter-container",children:[Object(h.jsx)(o.z,{className:"marker-filter-container-tag",minimal:!0,intent:"primary",children:"Log-FC"}),Object(h.jsx)(P,{data:Oe,height:35,color:"#F5498B"}),Object(h.jsx)("div",{className:"marker-filter-slider",children:K&&Object(h.jsx)(o.w,{min:K[0],max:K[1],stepSize:Math.round(K[1]-K[0])/25,onChange:function(e){return Te(e,"lfc")},value:(null===ye||void 0===ye?void 0:ye.lfc)?null===ye||void 0===ye?void 0:ye.lfc:K,vertical:!1})})]}),Object(h.jsxs)("div",{className:"marker-filter-container",children:[Object(h.jsx)(o.z,{className:"marker-filter-container-tag",minimal:!0,intent:"primary",children:"\u0394-detected"}),Object(h.jsx)(P,{data:de,height:35,color:"#4580E6"}),Object(h.jsx)("div",{className:"marker-filter-slider",children:W&&Object(h.jsx)(o.w,{min:W[0],max:W[1],stepSize:Math.round(W[1]-W[0])/25,onChange:function(e){return Te(e,"delta")},value:(null===ye||void 0===ye?void 0:ye.delta)?null===ye||void 0===ye?void 0:ye.delta:W,vertical:!1})})]}),Object(h.jsxs)("div",{className:"marker-filter-container",children:[Object(h.jsx)(o.z,{className:"marker-filter-container-tag",minimal:!0,intent:"primary",children:"Mean"}),Object(h.jsx)(P,{data:le,height:35}),Object(h.jsx)("div",{className:"marker-filter-slider",children:T&&Object(h.jsx)(o.w,{min:T[0],max:T[1],stepSize:Math.round(T[1]-T[0])/25,onChange:function(e){return Te(e,"mean")},value:(null===ye||void 0===ye?void 0:ye.mean)?null===ye||void 0===ye?void 0:ye.mean:T,vertical:!1})})]}),Object(h.jsxs)("div",{className:"marker-filter-container",children:[Object(h.jsx)(o.z,{className:"marker-filter-container-tag",minimal:!0,intent:"primary",children:"Detected"}),Object(h.jsx)(P,{data:xe,height:35}),Object(h.jsx)("div",{className:"marker-filter-slider",children:$&&Object(h.jsx)(o.w,{min:$[0],max:$[1],stepSize:Math.round($[1]-$[0])/25,onChange:function(e){return Te(e,"detected")},value:(null===ye||void 0===ye?void 0:ye.detected)?null===ye||void 0===ye?void 0:ye.detected:$,vertical:!1})})]})]})]}):""]})};var H=function(){var e=Object(a.useState)(!0),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(a.useContext)(O),u=c.setWasmInitialized,d=c.setTsneData,j=c.setRedDims,b=c.redDims,p=c.setInitDims,m=c.setQcDims,f=c.defaultRedDims,x=c.setDefaultRedDims,v=c.setQcData,g=c.qcData,F=c.setClusterData,y=c.setFSelectionData,C=c.setUmapData,N=c.setPcaVarExp,k=c.logs,A=c.setLogs,D=c.selectedCluster,E=c.clusterRank,S=c.selectedClusterSummary,M=c.setSelectedClusterSummary,B=c.reqGene;return Object(a.useEffect)((function(){window.Worker.postMessage({type:"INIT",msg:"Initial Load"})}),[]),Object(a.useEffect)((function(){null!==D&&window.Worker.postMessage({type:"getMarkersForCluster",payload:{cluster:D,rank_type:E}})}),[D,E]),Object(a.useEffect)((function(){null!==B&&window.Worker.postMessage({type:"getGeneExpression",payload:{gene:B}})}),[B]),window.Worker.onmessage=function(e){var t=e.data;if(null===t||void 0===t?void 0:t.msg){var n=Object(l.a)(k),a=new Date;n.push("".concat(a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()," - ").concat(null===t||void 0===t?void 0:t.type," - ").concat(null===t||void 0===t?void 0:t.msg)),A(n)}if("INIT"===t.type)r(!1),u(!0);else if("input_DIMS"===t.type)p(t.resp);else if("quality_control_filtered_DIMS"===t.type)m(t.resp);else if("quality_control_metrics_DATA"===t.type){var c=t.resp;v(c)}else if("quality_control_thresholds_DATA"===t.type){var i=t.resp,o=Object(s.a)({},g);o.thresholds=i,v(o)}else if("feature_selection_DIMS"===t.type);else if("feature_selection_DATA"===t.type){var h=t.resp;y(h)}else if("pca_DATA"===t.type){var O=t.resp,w=Object(l.a)(b);w.push("PCA"),j(w),N(O)}else if("snn_cluster_graph_DATA"===t.type){var D=t.resp;F(D)}else if("tsne_DATA"===t.type||"tsne_iter"===t.type){var E=t.resp;d(E);var L=Object(l.a)(b);L.push("TSNE"),f||x("TSNE"),j(L)}else if("umap_DATA"===t.type){var B=t.resp;C(B);var T=Object(l.a)(b);T.push("UMAP"),j(T)}else if("markerGene_DATA"===t.type);else if("setMarkersForCluster"===t.type){var R=t.resp,I={};R.means.forEach((function(e,t){var n,a,r,c,s;I[null===R||void 0===R||null===(n=R.genes)||void 0===n?void 0:n[t]]={gene:null===R||void 0===R||null===(a=R.genes)||void 0===a?void 0:a[t],mean:e,delta:null===R||void 0===R||null===(r=R.delta_d)||void 0===r?void 0:r[t],lfc:null===R||void 0===R||null===(c=R.lfc)||void 0===c?void 0:c[t],detected:null===R||void 0===R||null===(s=R.detected)||void 0===s?void 0:s[t],expanded:!1,expr:null}})),M(I)}else if("setGeneExpression"===t.type){var _=t.resp,q=Object(s.a)({},S);q[_.gene].expr=Object.values(_.expr),M(q)}},Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(w,{}),Object(h.jsxs)("div",{className:"App-content",children:[Object(h.jsx)("div",{className:"plot",children:Object(h.jsx)(_,{})}),Object(h.jsx)("div",{className:"marker",children:Object(h.jsx)(W,{})}),Object(h.jsx)("div",{className:"analysis",children:Object(h.jsx)(L,{})})]}),Object(h.jsx)(o.u,Object(s.a)(Object(s.a)({isOpen:n},{autoFocus:!0,canEscapeKeyClose:!1,canOutsideClickClose:!1,enforceFocus:!0,hasBackdrop:!0,usePortal:!0,useTallContent:!1}),{},{children:Object(h.jsxs)("div",{className:"spinner",children:[Object(h.jsx)(o.x,{size:100}),Object(h.jsx)("p",{children:"Initializing SCRAN.JS"})]})}))]})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,341)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};c.a.render(Object(h.jsx)(p,{children:Object(h.jsx)(H,{})}),document.getElementById("root")),Q()}},[[332,1,2]]]);
//# sourceMappingURL=main.1acd369e.chunk.js.map